<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>12 Path Analysis | Comparative Methods Workshops</title>
  <meta name="description" content="These are the workshops for the Comparative Research Group as part of LIFE363" />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="12 Path Analysis | Comparative Methods Workshops" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="These are the workshops for the Comparative Research Group as part of LIFE363" />
  <meta name="github-repo" content="ChrisMitchell42/bookdownCRG" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="12 Path Analysis | Comparative Methods Workshops" />
  
  <meta name="twitter:description" content="These are the workshops for the Comparative Research Group as part of LIFE363" />
  

<meta name="author" content="Chris Mitchell" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="w2PGLS.html"/>
<link rel="next" href="convergence.html"/>
<script src="libs/header-attrs-2.3/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/iframe-resizer/3.5.16/iframeResizer.min.js" type="text/javascript"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Comparative Research Group</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#for-students"><i class="fa fa-check"></i><b>1.1</b> For students</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a>
<ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#what-is-the-comparative-method"><i class="fa fa-check"></i><b>2.1</b> What is the comparative method?</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#tree-thinking"><i class="fa fa-check"></i><b>2.2</b> Tree thinking</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="recap.html"><a href="recap.html"><i class="fa fa-check"></i><b>3</b> R recap</a>
<ul>
<li class="chapter" data-level="3.1" data-path="recap.html"><a href="recap.html#basics"><i class="fa fa-check"></i><b>3.1</b> Basics</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="recap.html"><a href="recap.html#plotting"><i class="fa fa-check"></i><b>3.1.1</b> Plotting</a></li>
<li class="chapter" data-level="3.1.2" data-path="recap.html"><a href="recap.html#the-working-directory"><i class="fa fa-check"></i><b>3.1.2</b> The working directory</a></li>
<li class="chapter" data-level="3.1.3" data-path="recap.html"><a href="recap.html#loading-data"><i class="fa fa-check"></i><b>3.1.3</b> Loading data</a></li>
<li class="chapter" data-level="3.1.4" data-path="recap.html"><a href="recap.html#subsetting"><i class="fa fa-check"></i><b>3.1.4</b> Subsetting</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="recap.html"><a href="recap.html#errors"><i class="fa fa-check"></i><b>3.2</b> Errors</a></li>
<li class="chapter" data-level="3.3" data-path="recap.html"><a href="recap.html#google"><i class="fa fa-check"></i><b>3.3</b> Google</a></li>
<li class="chapter" data-level="3.4" data-path="recap.html"><a href="recap.html#stealing"><i class="fa fa-check"></i><b>3.4</b> Stealing</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="phylogenetics.html"><a href="phylogenetics.html"><i class="fa fa-check"></i><b>4</b> Phylogenetic trees and where to find them</a>
<ul>
<li class="chapter" data-level="4.1" data-path="phylogenetics.html"><a href="phylogenetics.html#phylogeny"><i class="fa fa-check"></i><b>4.1</b> Phylogeny</a></li>
<li class="chapter" data-level="4.2" data-path="phylogenetics.html"><a href="phylogenetics.html#building-trees"><i class="fa fa-check"></i><b>4.2</b> Building trees</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="phylogenetics.html"><a href="phylogenetics.html#morphology"><i class="fa fa-check"></i><b>4.2.1</b> Morphology</a></li>
<li class="chapter" data-level="4.2.2" data-path="phylogenetics.html"><a href="phylogenetics.html#molecular-data"><i class="fa fa-check"></i><b>4.2.2</b> Molecular data</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="phylogenetics.html"><a href="phylogenetics.html#tree-structure"><i class="fa fa-check"></i><b>4.3</b> Tree structure</a></li>
<li class="chapter" data-level="4.4" data-path="phylogenetics.html"><a href="phylogenetics.html#finding-trees"><i class="fa fa-check"></i><b>4.4</b> Finding trees</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="phylogenetics.html"><a href="phylogenetics.html#vertlife"><i class="fa fa-check"></i><b>4.4.1</b> Vertlife</a></li>
<li class="chapter" data-level="4.4.2" data-path="phylogenetics.html"><a href="phylogenetics.html#ktrees"><i class="fa fa-check"></i><b>4.4.2</b> 10ktrees</a></li>
<li class="chapter" data-level="4.4.3" data-path="phylogenetics.html"><a href="phylogenetics.html#treebase"><i class="fa fa-check"></i><b>4.4.3</b> TreeBASE</a></li>
<li class="chapter" data-level="4.4.4" data-path="phylogenetics.html"><a href="phylogenetics.html#primary-literature"><i class="fa fa-check"></i><b>4.4.4</b> Primary literature</a></li>
<li class="chapter" data-level="4.4.5" data-path="phylogenetics.html"><a href="phylogenetics.html#tree.drawer"><i class="fa fa-check"></i><b>4.4.5</b> tree.drawer</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="phylogenetics.html"><a href="phylogenetics.html#further-info"><i class="fa fa-check"></i><b>4.5</b> Further info</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="w1plotting.html"><a href="w1plotting.html"><i class="fa fa-check"></i><b>5</b> Plotting trees in R</a>
<ul>
<li class="chapter" data-level="5.1" data-path="w1plotting.html"><a href="w1plotting.html#phylogenies-in-r"><i class="fa fa-check"></i><b>5.1</b> Phylogenies in R</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="w1plotting.html"><a href="w1plotting.html#packages-used"><i class="fa fa-check"></i><b>5.1.1</b> Packages used</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="w1plotting.html"><a href="w1plotting.html#importing-your-tree"><i class="fa fa-check"></i><b>5.2</b> Importing your tree</a></li>
<li class="chapter" data-level="5.3" data-path="w1plotting.html"><a href="w1plotting.html#ggtree"><i class="fa fa-check"></i><b>5.3</b> ggtree</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="w1plotting.html"><a href="w1plotting.html#geoms"><i class="fa fa-check"></i><b>5.3.1</b> Geoms</a></li>
<li class="chapter" data-level="5.3.2" data-path="w1plotting.html"><a href="w1plotting.html#labelling-clades"><i class="fa fa-check"></i><b>5.3.2</b> Labelling clades</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="w1plotting.html"><a href="w1plotting.html#adding-images-to-trees"><i class="fa fa-check"></i><b>5.4</b> Adding images to trees</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="w1plotting.html"><a href="w1plotting.html#phylopic"><i class="fa fa-check"></i><b>5.4.1</b> Phylopic</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="w1plotting.html"><a href="w1plotting.html#further-info-1"><i class="fa fa-check"></i><b>5.5</b> Further info</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="anova.html"><a href="anova.html"><i class="fa fa-check"></i><b>6</b> ANOVA</a>
<ul>
<li class="chapter" data-level="6.1" data-path="anova.html"><a href="anova.html#analysis-of-variance"><i class="fa fa-check"></i><b>6.1</b> Analysis of variance</a></li>
<li class="chapter" data-level="6.2" data-path="anova.html"><a href="anova.html#phylogenetic-correction"><i class="fa fa-check"></i><b>6.2</b> Phylogenetic correction</a></li>
<li class="chapter" data-level="6.3" data-path="anova.html"><a href="anova.html#example-data-analysis"><i class="fa fa-check"></i><b>6.3</b> Example data &amp; analysis</a></li>
<li class="chapter" data-level="6.4" data-path="anova.html"><a href="anova.html#further-info-2"><i class="fa fa-check"></i><b>6.4</b> Further info</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="asr1.html"><a href="asr1.html"><i class="fa fa-check"></i><b>7</b> Ancestral State Reconstruction I</a>
<ul>
<li class="chapter" data-level="7.1" data-path="asr1.html"><a href="asr1.html#data"><i class="fa fa-check"></i><b>7.1</b> Data</a></li>
<li class="chapter" data-level="7.2" data-path="asr1.html"><a href="asr1.html#trees"><i class="fa fa-check"></i><b>7.2</b> Trees</a></li>
<li class="chapter" data-level="7.3" data-path="asr1.html"><a href="asr1.html#parsimony"><i class="fa fa-check"></i><b>7.3</b> Parsimony</a></li>
<li class="chapter" data-level="7.4" data-path="asr1.html"><a href="asr1.html#maximum-likelihood"><i class="fa fa-check"></i><b>7.4</b> Maximum Likelihood</a></li>
<li class="chapter" data-level="7.5" data-path="asr1.html"><a href="asr1.html#stochastic-character-mapping"><i class="fa fa-check"></i><b>7.5</b> Stochastic Character Mapping</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="asr1.html"><a href="asr1.html#an-analogy"><i class="fa fa-check"></i><b>7.5.1</b> An Analogy</a></li>
<li class="chapter" data-level="7.5.2" data-path="asr1.html"><a href="asr1.html#state-characters"><i class="fa fa-check"></i><b>7.5.2</b> 2-State Characters</a></li>
<li class="chapter" data-level="7.5.3" data-path="asr1.html"><a href="asr1.html#state-characters-1"><i class="fa fa-check"></i><b>7.5.3</b> 3-State Characters</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="asr1.html"><a href="asr1.html#further-info-3"><i class="fa fa-check"></i><b>7.6</b> Further info</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="asr2.html"><a href="asr2.html"><i class="fa fa-check"></i><b>8</b> Ancestral State Reconstruction II</a>
<ul>
<li class="chapter" data-level="8.1" data-path="asr2.html"><a href="asr2.html#data-2"><i class="fa fa-check"></i><b>8.1</b> Data</a></li>
<li class="chapter" data-level="8.2" data-path="asr2.html"><a href="asr2.html#tree"><i class="fa fa-check"></i><b>8.2</b> Tree</a></li>
<li class="chapter" data-level="8.3" data-path="asr2.html"><a href="asr2.html#ancestral-state-reconstructions"><i class="fa fa-check"></i><b>8.3</b> Ancestral State Reconstructions</a></li>
<li class="chapter" data-level="8.4" data-path="asr2.html"><a href="asr2.html#bayestraits"><i class="fa fa-check"></i><b>8.4</b> BayesTraits</a></li>
<li class="chapter" data-level="8.5" data-path="asr2.html"><a href="asr2.html#modelling-evolution"><i class="fa fa-check"></i><b>8.5</b> Modelling Evolution</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="asr2.html"><a href="asr2.html#brownian-motion"><i class="fa fa-check"></i><b>8.5.1</b> Brownian Motion</a></li>
<li class="chapter" data-level="8.5.2" data-path="asr2.html"><a href="asr2.html#directional-evolution"><i class="fa fa-check"></i><b>8.5.2</b> Directional Evolution</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="asr2.html"><a href="asr2.html#changes-in-the-rate-of-evolution-of-a-trait"><i class="fa fa-check"></i><b>8.6</b> Changes in the rate of evolution of a trait</a></li>
<li class="chapter" data-level="8.7" data-path="asr2.html"><a href="asr2.html#uncertainty"><i class="fa fa-check"></i><b>8.7</b> Uncertainty</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="asr2.html"><a href="asr2.html#fossils"><i class="fa fa-check"></i><b>8.7.1</b> Fossils</a></li>
<li class="chapter" data-level="8.7.2" data-path="asr2.html"><a href="asr2.html#revisiting-mysticete-body-mass"><i class="fa fa-check"></i><b>8.7.2</b> Revisiting Mysticete Body Mass</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="asr2.html"><a href="asr2.html#further-info-4"><i class="fa fa-check"></i><b>8.8</b> Further info</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="diversification.html"><a href="diversification.html"><i class="fa fa-check"></i><b>9</b> Diversification</a>
<ul>
<li class="chapter" data-level="9.1" data-path="diversification.html"><a href="diversification.html#introduction"><i class="fa fa-check"></i><b>9.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="diversification.html"><a href="diversification.html#pure-birth-model"><i class="fa fa-check"></i><b>9.1.1</b> Pure Birth Model</a></li>
<li class="chapter" data-level="9.1.2" data-path="diversification.html"><a href="diversification.html#the-birth-death-model"><i class="fa fa-check"></i><b>9.1.2</b> The Birth-Death Model</a></li>
<li class="chapter" data-level="9.1.3" data-path="diversification.html"><a href="diversification.html#the-signature-of-extinction"><i class="fa fa-check"></i><b>9.1.3</b> The signature of extinction</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="diversification.html"><a href="diversification.html#estimating-speciation-and-extinction-rate"><i class="fa fa-check"></i><b>9.2</b> Estimating speciation and extinction rate</a></li>
<li class="chapter" data-level="9.3" data-path="diversification.html"><a href="diversification.html#medusa"><i class="fa fa-check"></i><b>9.3</b> MEDUSA</a></li>
<li class="chapter" data-level="9.4" data-path="diversification.html"><a href="diversification.html#rpanda"><i class="fa fa-check"></i><b>9.4</b> RPANDA</a></li>
<li class="chapter" data-level="9.5" data-path="diversification.html"><a href="diversification.html#bamm-bammtools"><i class="fa fa-check"></i><b>9.5</b> BAMM &amp; BAMMtools</a></li>
<li class="chapter" data-level="9.6" data-path="diversification.html"><a href="diversification.html#further-info-5"><i class="fa fa-check"></i><b>9.6</b> Further info</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="diversification2.html"><a href="diversification2.html"><i class="fa fa-check"></i><b>10</b> Trait Dependent Diversification</a>
<ul>
<li class="chapter" data-level="10.1" data-path="diversification2.html"><a href="diversification2.html#binary-traits-bisse"><i class="fa fa-check"></i><b>10.1</b> Binary traits: BiSSE</a></li>
<li class="chapter" data-level="10.2" data-path="diversification2.html"><a href="diversification2.html#multi-state-traits-musse"><i class="fa fa-check"></i><b>10.2</b> Multi-state traits: MuSSE</a></li>
<li class="chapter" data-level="10.3" data-path="diversification2.html"><a href="diversification2.html#quantitative-traits-quasse"><i class="fa fa-check"></i><b>10.3</b> Quantitative traits: QuaSSE</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="diversification2.html"><a href="diversification2.html#quasse-primate-example"><i class="fa fa-check"></i><b>10.3.1</b> QuaSSE primate example</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="w2PGLS.html"><a href="w2PGLS.html"><i class="fa fa-check"></i><b>11</b> Phylogenetic Regression</a>
<ul>
<li class="chapter" data-level="11.1" data-path="w2PGLS.html"><a href="w2PGLS.html#data-3"><i class="fa fa-check"></i><b>11.1</b> Data</a></li>
<li class="chapter" data-level="11.2" data-path="w2PGLS.html"><a href="w2PGLS.html#linear-regression"><i class="fa fa-check"></i><b>11.2</b> Linear Regression</a></li>
<li class="chapter" data-level="11.3" data-path="w2PGLS.html"><a href="w2PGLS.html#phylogenetic-signal"><i class="fa fa-check"></i><b>11.3</b> Phylogenetic Signal</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="w2PGLS.html"><a href="w2PGLS.html#phylogenetic-signal-1"><i class="fa fa-check"></i><b>11.3.1</b> Phylogenetic signal</a></li>
<li class="chapter" data-level="11.3.2" data-path="w2PGLS.html"><a href="w2PGLS.html#caper"><i class="fa fa-check"></i><b>11.3.2</b> caper</a></li>
<li class="chapter" data-level="11.3.3" data-path="w2PGLS.html"><a href="w2PGLS.html#estimating-phylogenetic-signal"><i class="fa fa-check"></i><b>11.3.3</b> Estimating Phylogenetic Signal</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="w2PGLS.html"><a href="w2PGLS.html#phylogenetic-regression"><i class="fa fa-check"></i><b>11.4</b> Phylogenetic Regression</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="w2PGLS.html"><a href="w2PGLS.html#model-checking"><i class="fa fa-check"></i><b>11.4.1</b> Model Checking</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="w2PGLS.html"><a href="w2PGLS.html#conclusion"><i class="fa fa-check"></i><b>11.5</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="pathanalysis.html"><a href="pathanalysis.html"><i class="fa fa-check"></i><b>12</b> Path Analysis</a>
<ul>
<li class="chapter" data-level="12.1" data-path="pathanalysis.html"><a href="pathanalysis.html#pgls-regression"><i class="fa fa-check"></i><b>12.1</b> PGLS regression</a></li>
<li class="chapter" data-level="12.2" data-path="pathanalysis.html"><a href="pathanalysis.html#variance-inflation"><i class="fa fa-check"></i><b>12.2</b> Variance Inflation</a></li>
<li class="chapter" data-level="12.3" data-path="pathanalysis.html"><a href="pathanalysis.html#path-analysis"><i class="fa fa-check"></i><b>12.3</b> Path Analysis</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="pathanalysis.html"><a href="pathanalysis.html#example"><i class="fa fa-check"></i><b>12.3.1</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="pathanalysis.html"><a href="pathanalysis.html#conclusion-1"><i class="fa fa-check"></i><b>12.4</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="convergence.html"><a href="convergence.html"><i class="fa fa-check"></i><b>13</b> Studying Convergence</a>
<ul>
<li class="chapter" data-level="13.1" data-path="convergence.html"><a href="convergence.html#indentifying-convergent-evolution"><i class="fa fa-check"></i><b>13.1</b> Indentifying convergent evolution</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="convergence.html"><a href="convergence.html#surface"><i class="fa fa-check"></i><b>13.1.1</b> SURFACE</a></li>
<li class="chapter" data-level="13.1.2" data-path="convergence.html"><a href="convergence.html#a-super-example"><i class="fa fa-check"></i><b>13.1.2</b> A Super Example</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="convergence.html"><a href="convergence.html#quantifying-convergent-evolution"><i class="fa fa-check"></i><b>13.2</b> Quantifying convergent evolution</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="convergence.html"><a href="convergence.html#the-wheatsheaf-index"><i class="fa fa-check"></i><b>13.2.1</b> The Wheatsheaf Index</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="bibliography.html"><a href="bibliography.html"><i class="fa fa-check"></i><b>14</b> Bibliography</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Comparative Methods Workshops</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="pathanalysis" class="section level1" number="12">
<h1><span class="header-section-number">12</span> Path Analysis</h1>
<div id="pgls-regression" class="section level2" number="12.1">
<h2><span class="header-section-number">12.1</span> PGLS regression</h2>
<p>Let’s have a closer look at using PGLS regression in statistical analyses. We’ll be using the same data and tree from the previous chapter.</p>
<p>If we have a look into the data file provided, we notice a number of continuous variables describing primates. Let’s say we’re interested in what makes some primates live such long lives. The natural thing to do, is run a PGLS regression with longevity as the outcome.</p>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="pathanalysis.html#cb301-1"></a><span class="kw">names</span>(primate.data)</span></code></pre></div>
<pre><code>[1] &quot;Order&quot;           &quot;Family&quot;          &quot;Binomial&quot;        &quot;AdultBodyMass_g&quot;
[5] &quot;GestationLen_d&quot;  &quot;HomeRange_km2&quot;   &quot;MaxLongevity_m&quot;  &quot;SocialGroupSize&quot;</code></pre>
<p>First, we need a comparative data object combining our data and tree.</p>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="pathanalysis.html#cb303-1"></a><span class="kw">library</span>(caper)</span>
<span id="cb303-2"><a href="pathanalysis.html#cb303-2"></a>primates&lt;-<span class="kw">comparative.data</span>(<span class="dt">phy =</span> primate.tree, <span class="dt">data =</span> primate.data, </span>
<span id="cb303-3"><a href="pathanalysis.html#cb303-3"></a>                           <span class="dt">names.col =</span> Binomial, <span class="dt">vcv =</span> <span class="ot">TRUE</span>, </span>
<span id="cb303-4"><a href="pathanalysis.html#cb303-4"></a>                           <span class="dt">na.omit =</span> <span class="ot">FALSE</span>, <span class="dt">warn.dropped =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<p>Now we can assemble and run our model. We want to predict longevity. Many things might influence longevity so how about something like this.</p>
<p><span class="math display">\[ \text{Longevity = Body Mass + Gestation + Home Range + Group Size}\]</span></p>
<p>Pretty much all of those will need to be log transformed in our model. We can do this ahead of time to make the code easier.</p>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb304-1"><a href="pathanalysis.html#cb304-1"></a>primates<span class="op">$</span>data<span class="op">$</span>log.mass &lt;-<span class="st"> </span><span class="kw">log10</span>(primates<span class="op">$</span>data<span class="op">$</span>AdultBodyMass_g)</span>
<span id="cb304-2"><a href="pathanalysis.html#cb304-2"></a>primates<span class="op">$</span>data<span class="op">$</span>log.gestation &lt;-<span class="st"> </span><span class="kw">log10</span>(primates<span class="op">$</span>data<span class="op">$</span>GestationLen_d)</span>
<span id="cb304-3"><a href="pathanalysis.html#cb304-3"></a>primates<span class="op">$</span>data<span class="op">$</span>log.range &lt;-<span class="st"> </span><span class="kw">log10</span>(primates<span class="op">$</span>data<span class="op">$</span>HomeRange_km2)</span>
<span id="cb304-4"><a href="pathanalysis.html#cb304-4"></a>primates<span class="op">$</span>data<span class="op">$</span>log.group &lt;-<span class="st"> </span><span class="kw">log10</span>(primates<span class="op">$</span>data<span class="op">$</span>SocialGroupSize)</span>
<span id="cb304-5"><a href="pathanalysis.html#cb304-5"></a>primates<span class="op">$</span>data<span class="op">$</span>log.lifespan &lt;-<span class="st"> </span><span class="kw">log10</span>(primates<span class="op">$</span>data<span class="op">$</span>MaxLongevity_m)</span></code></pre></div>
<p>Now we can run the model just as we did in the previous chapter.</p>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="pathanalysis.html#cb305-1"></a>m1 &lt;-<span class="st"> </span><span class="kw">pgls</span>(log.lifespan <span class="op">~</span><span class="st"> </span>log.mass <span class="op">+</span><span class="st"> </span>log.gestation <span class="op">+</span><span class="st"> </span>log.range <span class="op">+</span><span class="st"> </span>log.group,</span>
<span id="cb305-2"><a href="pathanalysis.html#cb305-2"></a>           <span class="dt">data =</span> primates, <span class="dt">lambda =</span> <span class="st">&quot;ML&quot;</span>)</span>
<span id="cb305-3"><a href="pathanalysis.html#cb305-3"></a><span class="kw">summary</span>(m1)</span></code></pre></div>
<pre><code>
Call:
pgls(formula = log.lifespan ~ log.mass + log.gestation + log.range + 
    log.group, data = primates, lambda = &quot;ML&quot;)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.045758 -0.011997  0.001693  0.008869  0.042009 

Branch length transformations:

kappa  [Fix]  : 1.000
lambda [ ML]  : 0.683
   lower bound : 0.000, p = 0.030195
   upper bound : 1.000, p = 1.9055e-12
   95.0% CI   : (0.168, 0.889)
delta  [Fix]  : 1.000

Coefficients:
               Estimate Std. Error t value  Pr(&gt;|t|)    
(Intercept)    2.119950   0.404224  5.2445 1.307e-06 ***
log.mass       0.126652   0.045236  2.7998  0.006443 ** 
log.gestation -0.037853   0.212621 -0.1780  0.859162    
log.range      0.027879   0.023855  1.1687  0.246091    
log.group      0.028718   0.038070  0.7544  0.452910    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.01793 on 78 degrees of freedom
Multiple R-squared: 0.2713, Adjusted R-squared: 0.234 
F-statistic: 7.262 on 4 and 78 DF,  p-value: 5.036e-05 </code></pre>
<p>We have a <span class="math inline">\(\lambda\)</span> of 0.683. This is <strong>not</strong> the phylogenetic signal of lifespan or any other variable in the model. Rather, it is the phylogenetic signal of the residuals of the model. As you can see, there clearly is a signal here and it’s different from 0 (p = 0.03) and 1 (p &lt; 0.001). However, as you can see from the lambda profile below, the CIs are very wide.</p>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb307-1"><a href="pathanalysis.html#cb307-1"></a><span class="kw">plot</span>(<span class="kw">pgls.profile</span>(m1, <span class="dt">which =</span> <span class="st">&quot;lambda&quot;</span>))</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-292-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Not to worry! On we go. The coefficients table in the results output is what we really want to look at here. We can see that the overall fit of the model is significant (R<sup>2</sup> = 0.23, p &lt; 0.001) but a little underwhelming. The only significant predictor of longevity in our model is body mass (<span class="math inline">\(\beta\)</span> = 0.13, se = 0.05, p = 0.006). Our other variables do not significantly predict lifespan.</p>
<p>However, we’re not done yet! This is where we can employ deletion testing. It is pretty clear that gestation is the most useless component of our model (<span class="math inline">\(\beta\)</span> = -0.04, se = 0.21, p = 0.86). An effect size around 0 with a large standard error and p-value is something we don’t need in our lives. So we can re-run the model dropping this variable.</p>
<p>IMPORTANT: ONLY DROP ONE VARIABLE AT A TIME!</p>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb308-1"><a href="pathanalysis.html#cb308-1"></a>m2 &lt;-<span class="st"> </span><span class="kw">pgls</span>(log.lifespan <span class="op">~</span><span class="st"> </span>log.mass <span class="op">+</span><span class="st"> </span>log.range <span class="op">+</span><span class="st"> </span>log.group,</span>
<span id="cb308-2"><a href="pathanalysis.html#cb308-2"></a>           <span class="dt">data =</span> primates, <span class="dt">lambda =</span> <span class="st">&quot;ML&quot;</span>)</span>
<span id="cb308-3"><a href="pathanalysis.html#cb308-3"></a><span class="kw">summary</span>(m2)</span></code></pre></div>
<pre><code>
Call:
pgls(formula = log.lifespan ~ log.mass + log.range + log.group, 
    data = primates, lambda = &quot;ML&quot;)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.052816 -0.013804 -0.000923  0.007778  0.037524 

Branch length transformations:

kappa  [Fix]  : 1.000
lambda [ ML]  : 0.681
   lower bound : 0.000, p = 0.018281
   upper bound : 1.000, p = 1.9111e-12
   95.0% CI   : (0.178, 0.889)
delta  [Fix]  : 1.000

Coefficients:
            Estimate Std. Error t value  Pr(&gt;|t|)    
(Intercept) 2.052722   0.142450 14.4101 &lt; 2.2e-16 ***
log.mass    0.122130   0.037140  3.2884  0.001506 ** 
log.range   0.028703   0.023321  1.2308  0.222061    
log.group   0.027939   0.037602  0.7430  0.459670    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.0178 on 79 degrees of freedom
Multiple R-squared: 0.2716, Adjusted R-squared: 0.2439 
F-statistic: 9.817 on 3 and 79 DF,  p-value: 1.412e-05 </code></pre>
<p>Our new output presents a similar picture. Body mass is significantly predicting longevity. This time we might want to look at dropping group size (<span class="math inline">\(\beta\)</span> = 0.03, se = 0.04, p = 0.46).</p>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb310-1"><a href="pathanalysis.html#cb310-1"></a>m3 &lt;-<span class="st"> </span><span class="kw">pgls</span>(log.lifespan <span class="op">~</span><span class="st"> </span>log.mass <span class="op">+</span><span class="st"> </span>log.range,</span>
<span id="cb310-2"><a href="pathanalysis.html#cb310-2"></a>           <span class="dt">data =</span> primates, <span class="dt">lambda =</span> <span class="st">&quot;ML&quot;</span>)</span>
<span id="cb310-3"><a href="pathanalysis.html#cb310-3"></a><span class="kw">summary</span>(m3)</span></code></pre></div>
<pre><code>
Call:
pgls(formula = log.lifespan ~ log.mass + log.range, data = primates, 
    lambda = &quot;ML&quot;)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.038916 -0.012031  0.000161  0.010589  0.040507 

Branch length transformations:

kappa  [Fix]  : 1.000
lambda [ ML]  : 0.669
   lower bound : 0.000, p = 0.020906
   upper bound : 1.000, p = 2.0745e-12
   95.0% CI   : (0.143, 0.886)
delta  [Fix]  : 1.000

Coefficients:
            Estimate Std. Error t value  Pr(&gt;|t|)    
(Intercept) 2.077904   0.137147 15.1510 &lt; 2.2e-16 ***
log.mass    0.120965   0.036786  3.2883  0.001499 ** 
log.range   0.035873   0.021436  1.6735  0.098141 .  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.01758 on 80 degrees of freedom
Multiple R-squared: 0.271,  Adjusted R-squared: 0.2528 
F-statistic: 14.87 on 2 and 80 DF,  p-value: 3.224e-06 </code></pre>
<p>Now we’re getting somewhere. We have reduced our maximal model to something a little more descriptive. We can keep going with this until we have eliminated all non-significant variables. However, at each stage, we should make sure that dropping variables doesn’t reduce our model fit! At each stage so far, the model fit has got better (see the bottom line of each output). What would happen if you also dropped range?</p>
<p>Also keep in mind that the model we’ve built here doesn’t use any interaction terms. These can be included just as in any other model and treated in the same way!</p>
</div>
<div id="variance-inflation" class="section level2" number="12.2">
<h2><span class="header-section-number">12.2</span> Variance Inflation</h2>
<p>In analyses like the one above, it is not uncommon to run into problems. When constructing a regression model, it is important to make sure your predictor variables don’t correlate.
<img src="bookdown-demo_files/figure-html/unnamed-chunk-295-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>As we can see here, this is clearly not the case. Exactly how much of a problem this can be is uncertain. Strong correlations are hugely problematic but weak ones are probably not that big a deal.</p>
<p>Imagine if we had two strongly correlated predictor variables in a model. How would we determine which one was causing the variation in our outcome? The more strongly correlated these predictors are, the more difficult it becomes to use them both to predict an outcome. This is called <strong>variance inflation</strong> (or multicollinearity).</p>
<p>The function <strong>vif</strong> in the package <strong>car</strong> <span class="citation">(Fox and Weisberg <a href="#ref-car" role="doc-biblioref">2019</a>)</span> calculates the variance inflation factor of a model. Here we can see that every variable in our model has a VIF greater than 1, indicating we do have some multicollinearity. However, there is no critical value beyond which variance inflation becomes a problem. As a general rule of thumb, a value that exceeds 5 is considered enough of a problem that you shouldn’t trust your results.</p>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb312-1"><a href="pathanalysis.html#cb312-1"></a>m1<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="kw">lm</span>(primates<span class="op">$</span>data<span class="op">$</span>log.lifespan <span class="op">~</span><span class="st"> </span>primates<span class="op">$</span>data<span class="op">$</span>log.mass <span class="op">+</span><span class="st"> </span></span>
<span id="cb312-2"><a href="pathanalysis.html#cb312-2"></a><span class="st">             </span>primates<span class="op">$</span>data<span class="op">$</span>log.gestation <span class="op">+</span><span class="st"> </span>primates<span class="op">$</span>data<span class="op">$</span>log.range <span class="op">+</span><span class="st"> </span></span>
<span id="cb312-3"><a href="pathanalysis.html#cb312-3"></a><span class="st">             </span>primates<span class="op">$</span>data<span class="op">$</span>log.group)</span>
<span id="cb312-4"><a href="pathanalysis.html#cb312-4"></a><span class="kw">library</span>(car)</span>
<span id="cb312-5"><a href="pathanalysis.html#cb312-5"></a><span class="kw">vif</span>(m1<span class="fl">.1</span>)</span></code></pre></div>
<pre><code>     primates$data$log.mass primates$data$log.gestation 
                   3.724550                    2.109221 
    primates$data$log.range     primates$data$log.group 
                   3.433493                    2.045929 </code></pre>
<p>So it may be that we don’t have a problem here and we’re probably ok to proceed. Note however that I had to calculate VIF for the uncorrected model (without phylogenetic correction) so the true values for the pgls may differ slightly.</p>
</div>
<div id="path-analysis" class="section level2" number="12.3">
<h2><span class="header-section-number">12.3</span> Path Analysis</h2>
<p>In comparative analyses, multicollinearity is to be expected. Many traits of a given animal are influenced by other traits. To solve this problem, we have path analysis <span class="citation">(von Hardenberg and Gonzalez-Voyer <a href="#ref-Hardenberg13" role="doc-biblioref">2013</a>, Gonzalez-Voyer and Von Hardenberg <a href="#ref-Gonzalez14" role="doc-biblioref">2014</a>)</span>.</p>
<p>In path analysis, we take a number of variables and define a <strong>causal model</strong>. This model consists of <strong>vertices</strong> (our variables) and <strong>arrows</strong> which define the relationships between the variables. This is an example of such a model.</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-297"></span>
<img src="Images/Dunbar07.jpg" alt="Predicted pathway model of primate brain evolution taken from Dunbar and Shultz (2007)." width="225" />
<p class="caption">
Figure 12.1: Predicted pathway model of primate brain evolution taken from Dunbar and Shultz (2007).
</p>
</div>
<p>Models like this one can be complex with many arrows showing a complex network of relationships. This is fairly typical of biological systems! If you study it closely, you’ll be able to see that it describes the interactions between variables. For example, <em>body size</em> directly influences <em>lifespan</em>, <em>home range</em>, <em>activity</em>, <em>BMR</em> and <em>diet</em>. The relationships described by these arrows represent a causal hypothesis.</p>
<p>Confirmatory path analysis was developed to test causal hypotheses that can be represented by <strong>Directed Acyclic Graphs</strong> (DAGs) <span class="citation">(Shipley <a href="#ref-Shipley00b" role="doc-biblioref">2000</a>)</span>. DAG is the term given to the graphical representation of the variables and the hypothesised relationships between them. We can test if a DAG is a reasonable hypothesis using a principle called <strong>distance-sepearation</strong> or d-sep for short <span class="citation">(Shipley <a href="#ref-Shipley00b" role="doc-biblioref">2000</a>)</span>.</p>
<p>D-sep tests <strong>conditional independencies</strong> in your DAG. If two vertices are not connected by an arrow, then the model implies that these variables are not causally linked.</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-298"></span>
<img src="Images/DAG1.png" alt="Example of a simple directed acyclic graph from Gonzalez-Voyer and Von Hardenberg 2014." width="286" />
<p class="caption">
Figure 12.2: Example of a simple directed acyclic graph from Gonzalez-Voyer and Von Hardenberg 2014.
</p>
</div>
<p>This example DAG contains a number of independencies. <strong>BM</strong> and <strong>DD</strong> are unconnected and therefore should be independent if this model is reasonable. We can actually build a model to test that indepedency as follows:</p>
<p><span class="math display">\[ \text{DD = BM + NL}\]</span></p>
<p>Note that <strong>NL</strong> must be included as a predictor of <strong>DD</strong> as it is in the model. If <strong>BM</strong> and <strong>DD</strong> are truly independent, then this model would return no statistically significant relationship between them.</p>
<p>This is not the only independency to test for. <strong>LS</strong> and <strong>RS</strong>, <strong>DD</strong> and <strong>LS</strong>, <strong>NL</strong> and <strong>LS</strong>, and <strong>BM</strong> and <strong>RS</strong> are all also independent under the DAG and so need to be tested in the same way. The probabilities of all these tests are combined using Fisher’s C test <span class="citation">(Shipley <a href="#ref-Shipley16" role="doc-biblioref">2016</a>)</span>.</p>
<p>To calculate C, we add the natural logs of all the p-values describing the supposed independencies using the formula below where <em>k</em> is the number of indepedence tests.</p>
<p><span class="math display">\[ C = -2 \sum_{i=1}^k \text{ln(p}_i) \]</span></p>
<p>Using this approach for numerous models, we can begin to compare competeing hypotheses and select the most appropriate model. To do so, we can calculate the C-statistic Information Criterion with a modification for small sample sizes (CICc) with the following formula where <em>n</em> is the sample size, <em>q</em> is the number of parameters and <em>C</em> is the C-statistic.</p>
<p><span class="math display">\[ \text{CICc} = C + 2q \times \frac{n}{(n - q - 1)}\]</span></p>
<p>CICc is an information theory based approach. Essentially, the smaller the value of CICc the better the fit of the model to the data. There’s no hard limit for distinguishing between two models but the general rule of thumb is that a difference in CICc of more than 2 mean that one model is a better fit than the other. Within 2 and we can’t reliably distinguish between the models.</p>
<p>So far, I’ve taken you through confirmatory path analysis but I haven’t mentioned phylogentic control at all. Path analysis without phylogenetic control is performed using generalised linear models (glms)</p>
<p>Let’s see how this works with an example.</p>
<div id="example" class="section level3" number="12.3.1">
<h3><span class="header-section-number">12.3.1</span> Example</h3>
<p>For this demonstration I’m loading in some new data <span class="citation">(von Hardenberg and Gonzalez-Voyer <a href="#ref-Hardenberg13" role="doc-biblioref">2013</a>, Gonzalez-Voyer and Von Hardenberg <a href="#ref-Gonzalez14" role="doc-biblioref">2014</a>)</span>. The data contains information on five continuous variables for 100 species from a group of mammals called the <em>Rhinogradentia</em> <span class="citation">(Stumpke <a href="#ref-snouters" role="doc-biblioref">1957</a>)</span>.</p>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb314-1"><a href="pathanalysis.html#cb314-1"></a>rhino.dat &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;rhino.csv&quot;</span>)</span>
<span id="cb314-2"><a href="pathanalysis.html#cb314-2"></a><span class="kw">rownames</span>(rhino.dat) &lt;-<span class="st"> </span>rhino.dat<span class="op">$</span>SP</span>
<span id="cb314-3"><a href="pathanalysis.html#cb314-3"></a>rhino.tree &lt;-<span class="st"> </span><span class="kw">read.tree</span>(<span class="st">&quot;rhino.tree&quot;</span>)</span></code></pre></div>
<p>Path analysis is something I used to do manually, model by model. However, as is usual in comparative studies, someone has written a package called <strong>phylopath</strong> that does it all quite simply <span class="citation">(van der Bijl <a href="#ref-phylopath" role="doc-biblioref">2018</a>)</span>. We’ll also need <strong>ggforce</strong> to help with plotting later on <span class="citation">(Pedersen <a href="#ref-ggforce" role="doc-biblioref">2019</a>)</span>.</p>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="pathanalysis.html#cb315-1"></a><span class="kw">install.packages</span>(<span class="st">&quot;phylopath&quot;</span>)</span>
<span id="cb315-2"><a href="pathanalysis.html#cb315-2"></a><span class="kw">install.packages</span>(<span class="st">&quot;ggforce&quot;</span>)</span>
<span id="cb315-3"><a href="pathanalysis.html#cb315-3"></a><span class="kw">require</span>(phylopath)</span>
<span id="cb315-4"><a href="pathanalysis.html#cb315-4"></a><span class="kw">require</span>(ggforce)</span></code></pre></div>
<p>The first step is to define the models using the function <strong>define_model_set</strong>. Take your time over this! Typos will be very important. In this instance, let’s reproduce the example DAG from above. The formulae are passed in the same style as any formula in R.</p>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb316-1"><a href="pathanalysis.html#cb316-1"></a>m &lt;-<span class="st"> </span><span class="kw">define_model_set</span>(</span>
<span id="cb316-2"><a href="pathanalysis.html#cb316-2"></a>  <span class="dt">Example =</span> <span class="kw">c</span>(RS <span class="op">~</span><span class="st"> </span>DD, LS <span class="op">~</span><span class="st"> </span>BM, NL <span class="op">~</span><span class="st"> </span>BM, DD <span class="op">~</span><span class="st"> </span>NL)</span>
<span id="cb316-3"><a href="pathanalysis.html#cb316-3"></a>)</span></code></pre></div>
<p>We can plot the model using the function <strong>plot_model_set</strong>. The extra arguments here clean up the plot a little. <strong>box_x</strong> and <strong>box_y</strong> create a box around the vertices to force the arrows not to overlap with the text. <strong>text_size</strong> and <strong>edge_width</strong> set the font size and arrow size respectively.</p>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="pathanalysis.html#cb317-1"></a><span class="kw">plot_model_set</span>(m, <span class="dt">text_size =</span> <span class="dv">10</span>,</span>
<span id="cb317-2"><a href="pathanalysis.html#cb317-2"></a>               <span class="dt">box_x =</span> <span class="dv">18</span>, <span class="dt">box_y =</span> <span class="dv">16</span>,</span>
<span id="cb317-3"><a href="pathanalysis.html#cb317-3"></a>               <span class="dt">edge_width =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-304-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>The layout isn’t exactly the same as the previous diagram but we can manipulate that with the argument <strong>manual_layout</strong> if we wish. We need to create a dataframe with x and y coordinates for the final plots. We can also set the arrows to be straight by setting <strong>curvature</strong> to be 0.</p>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb318-1"><a href="pathanalysis.html#cb318-1"></a>pos &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">names =</span> <span class="kw">c</span>(<span class="st">&quot;RS&quot;</span>, <span class="st">&quot;DD&quot;</span>, <span class="st">&quot;NL&quot;</span>, <span class="st">&quot;BM&quot;</span>, <span class="st">&quot;LS&quot;</span>),</span>
<span id="cb318-2"><a href="pathanalysis.html#cb318-2"></a>                  <span class="dt">x =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">1.5</span>,<span class="fl">1.5</span>,.<span class="dv">5</span>,.<span class="dv">5</span>),</span>
<span id="cb318-3"><a href="pathanalysis.html#cb318-3"></a>                  <span class="dt">y =</span> <span class="kw">c</span>(<span class="dv">0</span>,.<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">1</span>,.<span class="dv">5</span>))</span>
<span id="cb318-4"><a href="pathanalysis.html#cb318-4"></a><span class="kw">plot_model_set</span>(m, <span class="dt">text_size =</span> <span class="dv">10</span>, <span class="dt">box_x =</span> <span class="dv">18</span>, <span class="dt">box_y =</span> <span class="dv">16</span>,</span>
<span id="cb318-5"><a href="pathanalysis.html#cb318-5"></a>               <span class="dt">edge_width =</span> <span class="dv">2</span>, <span class="dt">manual_layout =</span> pos, <span class="dt">curvature =</span> <span class="dv">0</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-305-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>For the full analysis, let’s define a number of possible models and try and see which best describes the data. We start with <strong>define_model_set</strong> and pass lists of formulae to each model which here I have named numerically 1 to 9. We’ve also passed some formulae to the <strong>.common</strong> option as these formulae are present in every model. This saves a fair bit of repetition.</p>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="pathanalysis.html#cb319-1"></a>m &lt;-<span class="st"> </span><span class="kw">define_model_set</span>(</span>
<span id="cb319-2"><a href="pathanalysis.html#cb319-2"></a>  <span class="dt">one   =</span> <span class="kw">c</span>(RS <span class="op">~</span><span class="st"> </span>DD),</span>
<span id="cb319-3"><a href="pathanalysis.html#cb319-3"></a>  <span class="dt">two   =</span> <span class="kw">c</span>(DD <span class="op">~</span><span class="st"> </span>NL, RS <span class="op">~</span><span class="st"> </span>LS <span class="op">+</span><span class="st"> </span>DD),</span>
<span id="cb319-4"><a href="pathanalysis.html#cb319-4"></a>  <span class="dt">three =</span> <span class="kw">c</span>(RS <span class="op">~</span><span class="st"> </span>NL),</span>
<span id="cb319-5"><a href="pathanalysis.html#cb319-5"></a>  <span class="dt">four  =</span> <span class="kw">c</span>(RS <span class="op">~</span><span class="st"> </span>BM <span class="op">+</span><span class="st"> </span>NL),</span>
<span id="cb319-6"><a href="pathanalysis.html#cb319-6"></a>  <span class="dt">five  =</span> <span class="kw">c</span>(RS <span class="op">~</span><span class="st"> </span>BM <span class="op">+</span><span class="st"> </span>NL <span class="op">+</span><span class="st"> </span>DD),</span>
<span id="cb319-7"><a href="pathanalysis.html#cb319-7"></a>  <span class="dt">six   =</span> <span class="kw">c</span>(NL <span class="op">~</span><span class="st"> </span>RS, RS <span class="op">~</span><span class="st"> </span>BM),</span>
<span id="cb319-8"><a href="pathanalysis.html#cb319-8"></a>  <span class="dt">seven =</span> <span class="kw">c</span>(NL <span class="op">~</span><span class="st"> </span>RS, RS <span class="op">~</span><span class="st"> </span>LS <span class="op">+</span><span class="st"> </span>BM),</span>
<span id="cb319-9"><a href="pathanalysis.html#cb319-9"></a>  <span class="dt">eight =</span> <span class="kw">c</span>(NL <span class="op">~</span><span class="st"> </span>RS),</span>
<span id="cb319-10"><a href="pathanalysis.html#cb319-10"></a>  <span class="dt">nine  =</span> <span class="kw">c</span>(NL <span class="op">~</span><span class="st"> </span>RS, RS <span class="op">~</span><span class="st"> </span>LS),</span>
<span id="cb319-11"><a href="pathanalysis.html#cb319-11"></a>  <span class="dt">.common =</span> <span class="kw">c</span>(LS <span class="op">~</span><span class="st"> </span>BM, NL <span class="op">~</span><span class="st"> </span>BM, DD <span class="op">~</span><span class="st"> </span>NL)</span>
<span id="cb319-12"><a href="pathanalysis.html#cb319-12"></a>)</span></code></pre></div>
<p>Because this is a complex step, ALWAYS check your <strong>Directed Acyclic Graphs</strong> (DAGs) describing your models look as you expect them to.</p>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb320-1"><a href="pathanalysis.html#cb320-1"></a><span class="kw">plot_model_set</span>(m, <span class="dt">text_size =</span> <span class="dv">6</span>, <span class="dt">box_x =</span> <span class="dv">12</span>, <span class="dt">box_y =</span> <span class="dv">10</span>,</span>
<span id="cb320-2"><a href="pathanalysis.html#cb320-2"></a>               <span class="dt">edge_width =</span> <span class="fl">1.25</span>, <span class="dt">manual_layout =</span> pos, <span class="dt">curvature =</span> <span class="dv">0</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-307-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>If we are doing this by hand, now we need to identify d-separation statements and test conditional independencies. <strong>Phylopath</strong> does it all for us. To interpret the final results, you really need to understand what happens in this step so take it slow and revisit the explanations above. You can also refer to the methods papers which explain things very well <span class="citation">(von Hardenberg and Gonzalez-Voyer <a href="#ref-Hardenberg13" role="doc-biblioref">2013</a>, Gonzalez-Voyer and Von Hardenberg <a href="#ref-Gonzalez14" role="doc-biblioref">2014</a>)</span>.</p>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="pathanalysis.html#cb321-1"></a>results &lt;-<span class="st"> </span><span class="kw">phylo_path</span>(m, <span class="dt">data =</span> rhino.dat, <span class="dt">tree =</span> rhino.tree, <span class="dt">model =</span> <span class="st">&quot;lambda&quot;</span>)</span></code></pre></div>
<p>If we call up the results, we get some basic information. Here our results contain the models and the PGLS analyses used to evaluate each model.</p>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb322-1"><a href="pathanalysis.html#cb322-1"></a>results</span></code></pre></div>
<pre><code>A phylogenetic path analysis, on the variables:
    Continuous:  BM NL DD RS LS 
    Binary:       

 Evaluated for these models: one two three four five six seven eight nine 

 Containing 46 phylogenetic regressions, of which 22 unique</code></pre>
<p>The summary of the results object gives us the table for model comparisons. For each model we have all the key stats. We can see that the top six models are not rejected based on d-separation (p &gt; 0.05). Pay particular attention to the CICc (C-statistic Information Criterion) and <span class="math inline">\(\Delta\)</span>CICc. You’ll notice that the table is helpfully sorted for us by <span class="math inline">\(\Delta\)</span>CICc.</p>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb324-1"><a href="pathanalysis.html#cb324-1"></a><span class="kw">summary</span>(results)</span></code></pre></div>
<pre><code>      model k  q     C        p CICc delta_CICc        l        w
eight eight 6  9  6.11 9.10e-01 26.1       0.00 1.00e+00 3.44e-01
four   four 5 10  4.78 9.05e-01 27.3       1.14 5.66e-01 1.95e-01
six     six 5 10  4.97 8.93e-01 27.4       1.33 5.14e-01 1.77e-01
nine   nine 5 10  5.73 8.37e-01 28.2       2.09 3.52e-01 1.21e-01
five   five 4 11  3.46 9.03e-01 28.5       2.34 3.10e-01 1.07e-01
seven seven 4 11  4.70 7.89e-01 29.7       3.59 1.66e-01 5.72e-02
three three 6  9 27.17 7.30e-03 47.2      21.06 2.68e-05 9.20e-06
one     one 6  9 62.01 9.70e-09 82.0      55.89 7.29e-13 2.51e-13
two     two 5 10 60.97 2.38e-09 83.4      57.33 3.56e-13 1.23e-13</code></pre>
<p>We can plot the summary of results and we are presented with a very useful plot, showing us the degree of support for each model. In this case, the top 3 (models eight, six and four) are within 2 CICc of each other and therefore have roughly equal statistical support.</p>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb326-1"><a href="pathanalysis.html#cb326-1"></a><span class="kw">plot</span>(<span class="kw">summary</span>(results))</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-311-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>For now, let’s just plot the best model.</p>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb327-1"><a href="pathanalysis.html#cb327-1"></a>best_model &lt;-<span class="st"> </span><span class="kw">best</span>(results)</span>
<span id="cb327-2"><a href="pathanalysis.html#cb327-2"></a><span class="kw">plot</span>(best_model, <span class="dt">manual_layout =</span> pos)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-312-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>The numbers and width of each arrow represent the path coefficents (effect sizes). The blue colour represents a positive relationship. A negative relationship would be red. Remember here that we have a few models with roughly equivalent support. We can average these models if this happens. The <strong>cut_off</strong> argument tells us where to place the limit of support. By default this is 2 CICc and so the function <strong>average</strong> will only average the models that fall within 2 CICc of the best supported model.</p>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb328-1"><a href="pathanalysis.html#cb328-1"></a>av.model &lt;-<span class="st"> </span><span class="kw">average</span>(results, <span class="dt">cut_off =</span> <span class="dv">2</span>)</span>
<span id="cb328-2"><a href="pathanalysis.html#cb328-2"></a><span class="kw">plot</span>(av.model, <span class="dt">algorithm =</span> <span class="st">&quot;mds&quot;</span>, <span class="dt">curvature =</span> <span class="fl">0.1</span>, <span class="dt">manual_layout =</span> pos)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-313-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="conclusion-1" class="section level2" number="12.4">
<h2><span class="header-section-number">12.4</span> Conclusion</h2>
<p>So that’s a path analysis. I’ve skirted over some details here because this particular method is complex and the package used here strips out a lot of the manual effort needed to do a path analysis. This is a good thing. It cuts down the computing time and means you don’t have to write as much code. However, it does mean you can run the analysis without really understanding it. This could be a problem when you need to write it up or present it so be sure you know what’s happening.</p>
<p>For getting to the end, here’s a slightly confused looking monkey.</p>
<p><img src="Images/monkey.png" width="364" style="display: block; margin: auto;" /></p>

</div>
</div>
<h3> Bibliography</h3>
<div id="refs" class="references">
<div id="ref-car">
<p>Fox, J. and Weisberg, S. (2019) <em>An R Companion to Applied Regression</em> [online] Third. Thousand Oaks CA: Sage. available from &lt;<a href="https://socialsciences.mcmaster.ca/jfox/Books/Companion/">https://socialsciences.mcmaster.ca/jfox/Books/Companion/</a>&gt;</p>
</div>
<div id="ref-Gonzalez14">
<p>Gonzalez-Voyer, A. and Von Hardenberg, A. (2014) ‘An Introduction to Phylogenetic Path Analysis’. in <em>Modern Phylogenetic Comparative Methods and Their Application in Evolutionary Biology</em>. Springer, 201–229</p>
</div>
<div id="ref-ggforce">
<p>Pedersen, T.L. (2019) <em>Ggforce: Accelerating ’Ggplot2’</em> [online] available from &lt;<a href="https://CRAN.R-project.org/package=ggforce">https://CRAN.R-project.org/package=ggforce</a>&gt;</p>
</div>
<div id="ref-Shipley16">
<p>Shipley, B. (2016) <em>Cause and Correlation in Biology: A User’s Guide to Path Analysis, Structural Equations and Causal Inference with R</em>. Cambridge University Press</p>
</div>
<div id="ref-Shipley00b">
<p>Shipley, B. (2000) ‘A New Inferential Test for Path Models Based on Directed Acyclic Graphs’. <em>Structural Equation Modeling</em> 7 (2), 206–218</p>
</div>
<div id="ref-snouters">
<p>Stumpke, H. (1957) <em>The Snouters: Form and Life of the Rhinogrades</em>. Stuttgart: Gustav Fischer Verlag</p>
</div>
<div id="ref-phylopath">
<p>van der Bijl, W. (2018) ‘Phylopath: Easy Phylogenetic Path Analysis in R.’ <em>PeerJ</em> 6, e4718</p>
</div>
<div id="ref-Hardenberg13">
<p>von Hardenberg, A. and Gonzalez-Voyer, A. (2013) ‘Disentangling Evolutionary Cause-Effect Relationships with Phylogenetic Confirmatory Path Analysis’. <em>Evolution</em> 67 - 2, 378–387</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="w2PGLS.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="convergence.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
