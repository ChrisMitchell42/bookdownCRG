<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>9 Ancestral State Reconstruction II | Comparative Methods Workshops</title>
  <meta name="description" content="These are the workshops for the Comparative Research Group as part of LIFE363" />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="9 Ancestral State Reconstruction II | Comparative Methods Workshops" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="These are the workshops for the Comparative Research Group as part of LIFE363" />
  <meta name="github-repo" content="ChrisMitchell42/bookdownCRG" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="9 Ancestral State Reconstruction II | Comparative Methods Workshops" />
  
  <meta name="twitter:description" content="These are the workshops for the Comparative Research Group as part of LIFE363" />
  

<meta name="author" content="Chris Mitchell" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="asr1.html"/>
<link rel="next" href="diversification.html"/>
<script src="libs/header-attrs-2.3/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/iframe-resizer/3.5.16/iframeResizer.min.js" type="text/javascript"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Comparative Research Group</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#for-students"><i class="fa fa-check"></i><b>1.1</b> For students</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a>
<ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#what-is-the-comparative-method"><i class="fa fa-check"></i><b>2.1</b> What is the comparative method?</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#tree-thinking"><i class="fa fa-check"></i><b>2.2</b> Tree thinking</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="recap.html"><a href="recap.html"><i class="fa fa-check"></i><b>3</b> R recap</a>
<ul>
<li class="chapter" data-level="3.1" data-path="recap.html"><a href="recap.html#basics"><i class="fa fa-check"></i><b>3.1</b> Basics</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="recap.html"><a href="recap.html#plotting"><i class="fa fa-check"></i><b>3.1.1</b> Plotting</a></li>
<li class="chapter" data-level="3.1.2" data-path="recap.html"><a href="recap.html#the-working-directory"><i class="fa fa-check"></i><b>3.1.2</b> The working directory</a></li>
<li class="chapter" data-level="3.1.3" data-path="recap.html"><a href="recap.html#loading-data"><i class="fa fa-check"></i><b>3.1.3</b> Loading data</a></li>
<li class="chapter" data-level="3.1.4" data-path="recap.html"><a href="recap.html#subsetting"><i class="fa fa-check"></i><b>3.1.4</b> Subsetting</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="recap.html"><a href="recap.html#errors"><i class="fa fa-check"></i><b>3.2</b> Errors</a></li>
<li class="chapter" data-level="3.3" data-path="recap.html"><a href="recap.html#google"><i class="fa fa-check"></i><b>3.3</b> Google</a></li>
<li class="chapter" data-level="3.4" data-path="recap.html"><a href="recap.html#stealing"><i class="fa fa-check"></i><b>3.4</b> Stealing</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="phylogenetics.html"><a href="phylogenetics.html"><i class="fa fa-check"></i><b>4</b> Phylogenetic trees and where to find them</a>
<ul>
<li class="chapter" data-level="4.1" data-path="phylogenetics.html"><a href="phylogenetics.html#phylogeny"><i class="fa fa-check"></i><b>4.1</b> Phylogeny</a></li>
<li class="chapter" data-level="4.2" data-path="phylogenetics.html"><a href="phylogenetics.html#building-trees"><i class="fa fa-check"></i><b>4.2</b> Building trees</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="phylogenetics.html"><a href="phylogenetics.html#morphology"><i class="fa fa-check"></i><b>4.2.1</b> Morphology</a></li>
<li class="chapter" data-level="4.2.2" data-path="phylogenetics.html"><a href="phylogenetics.html#molecular-data"><i class="fa fa-check"></i><b>4.2.2</b> Molecular data</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="phylogenetics.html"><a href="phylogenetics.html#tree-structure"><i class="fa fa-check"></i><b>4.3</b> Tree structure</a></li>
<li class="chapter" data-level="4.4" data-path="phylogenetics.html"><a href="phylogenetics.html#finding-trees"><i class="fa fa-check"></i><b>4.4</b> Finding trees</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="phylogenetics.html"><a href="phylogenetics.html#vertlife"><i class="fa fa-check"></i><b>4.4.1</b> Vertlife</a></li>
<li class="chapter" data-level="4.4.2" data-path="phylogenetics.html"><a href="phylogenetics.html#ktrees"><i class="fa fa-check"></i><b>4.4.2</b> 10ktrees</a></li>
<li class="chapter" data-level="4.4.3" data-path="phylogenetics.html"><a href="phylogenetics.html#treebase"><i class="fa fa-check"></i><b>4.4.3</b> TreeBASE</a></li>
<li class="chapter" data-level="4.4.4" data-path="phylogenetics.html"><a href="phylogenetics.html#primary-literature"><i class="fa fa-check"></i><b>4.4.4</b> Primary literature</a></li>
<li class="chapter" data-level="4.4.5" data-path="phylogenetics.html"><a href="phylogenetics.html#tree.drawer"><i class="fa fa-check"></i><b>4.4.5</b> tree.drawer</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="phylogenetics.html"><a href="phylogenetics.html#further-info"><i class="fa fa-check"></i><b>4.5</b> Further info</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="w1plotting.html"><a href="w1plotting.html"><i class="fa fa-check"></i><b>5</b> Plotting trees in R</a>
<ul>
<li class="chapter" data-level="5.1" data-path="w1plotting.html"><a href="w1plotting.html#phylogenies-in-r"><i class="fa fa-check"></i><b>5.1</b> Phylogenies in R</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="w1plotting.html"><a href="w1plotting.html#packages-used"><i class="fa fa-check"></i><b>5.1.1</b> Packages used</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="w1plotting.html"><a href="w1plotting.html#importing-your-tree"><i class="fa fa-check"></i><b>5.2</b> Importing your tree</a></li>
<li class="chapter" data-level="5.3" data-path="w1plotting.html"><a href="w1plotting.html#ggtree"><i class="fa fa-check"></i><b>5.3</b> ggtree</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="w1plotting.html"><a href="w1plotting.html#geoms"><i class="fa fa-check"></i><b>5.3.1</b> Geoms</a></li>
<li class="chapter" data-level="5.3.2" data-path="w1plotting.html"><a href="w1plotting.html#labelling-clades"><i class="fa fa-check"></i><b>5.3.2</b> Labelling clades</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="w1plotting.html"><a href="w1plotting.html#adding-images-to-trees"><i class="fa fa-check"></i><b>5.4</b> Adding images to trees</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="w1plotting.html"><a href="w1plotting.html#phylopic"><i class="fa fa-check"></i><b>5.4.1</b> Phylopic</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="w1plotting.html"><a href="w1plotting.html#further-info-1"><i class="fa fa-check"></i><b>5.5</b> Further info</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>6</b> Data</a>
<ul>
<li class="chapter" data-level="6.1" data-path="data.html"><a href="data.html#comparative-data"><i class="fa fa-check"></i><b>6.1</b> Comparative data</a></li>
<li class="chapter" data-level="6.2" data-path="data.html"><a href="data.html#databases"><i class="fa fa-check"></i><b>6.2</b> Databases</a></li>
<li class="chapter" data-level="6.3" data-path="data.html"><a href="data.html#data-riches"><i class="fa fa-check"></i><b>6.3</b> Data Riches</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="anova.html"><a href="anova.html"><i class="fa fa-check"></i><b>7</b> ANOVA</a>
<ul>
<li class="chapter" data-level="7.1" data-path="anova.html"><a href="anova.html#analysis-of-variance"><i class="fa fa-check"></i><b>7.1</b> Analysis of variance</a></li>
<li class="chapter" data-level="7.2" data-path="anova.html"><a href="anova.html#phylogenetic-correction"><i class="fa fa-check"></i><b>7.2</b> Phylogenetic correction</a></li>
<li class="chapter" data-level="7.3" data-path="anova.html"><a href="anova.html#example-data-analysis"><i class="fa fa-check"></i><b>7.3</b> Example data &amp; analysis</a></li>
<li class="chapter" data-level="7.4" data-path="anova.html"><a href="anova.html#further-info-2"><i class="fa fa-check"></i><b>7.4</b> Further info</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="asr1.html"><a href="asr1.html"><i class="fa fa-check"></i><b>8</b> Ancestral State Reconstruction I</a>
<ul>
<li class="chapter" data-level="8.1" data-path="asr1.html"><a href="asr1.html#data-1"><i class="fa fa-check"></i><b>8.1</b> Data</a></li>
<li class="chapter" data-level="8.2" data-path="asr1.html"><a href="asr1.html#trees"><i class="fa fa-check"></i><b>8.2</b> Trees</a></li>
<li class="chapter" data-level="8.3" data-path="asr1.html"><a href="asr1.html#parsimony"><i class="fa fa-check"></i><b>8.3</b> Parsimony</a></li>
<li class="chapter" data-level="8.4" data-path="asr1.html"><a href="asr1.html#maximum-likelihood"><i class="fa fa-check"></i><b>8.4</b> Maximum Likelihood</a></li>
<li class="chapter" data-level="8.5" data-path="asr1.html"><a href="asr1.html#stochastic-character-mapping"><i class="fa fa-check"></i><b>8.5</b> Stochastic Character Mapping</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="asr1.html"><a href="asr1.html#an-analogy"><i class="fa fa-check"></i><b>8.5.1</b> An Analogy</a></li>
<li class="chapter" data-level="8.5.2" data-path="asr1.html"><a href="asr1.html#state-characters"><i class="fa fa-check"></i><b>8.5.2</b> 2-State Characters</a></li>
<li class="chapter" data-level="8.5.3" data-path="asr1.html"><a href="asr1.html#state-characters-1"><i class="fa fa-check"></i><b>8.5.3</b> 3-State Characters</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="asr1.html"><a href="asr1.html#further-info-3"><i class="fa fa-check"></i><b>8.6</b> Further info</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="asr2.html"><a href="asr2.html"><i class="fa fa-check"></i><b>9</b> Ancestral State Reconstruction II</a>
<ul>
<li class="chapter" data-level="9.1" data-path="asr2.html"><a href="asr2.html#data-3"><i class="fa fa-check"></i><b>9.1</b> Data</a></li>
<li class="chapter" data-level="9.2" data-path="asr2.html"><a href="asr2.html#tree"><i class="fa fa-check"></i><b>9.2</b> Tree</a></li>
<li class="chapter" data-level="9.3" data-path="asr2.html"><a href="asr2.html#ancestral-state-reconstructions"><i class="fa fa-check"></i><b>9.3</b> Ancestral State Reconstructions</a></li>
<li class="chapter" data-level="9.4" data-path="asr2.html"><a href="asr2.html#bayestraits"><i class="fa fa-check"></i><b>9.4</b> BayesTraits</a></li>
<li class="chapter" data-level="9.5" data-path="asr2.html"><a href="asr2.html#modelling-evolution"><i class="fa fa-check"></i><b>9.5</b> Modelling Evolution</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="asr2.html"><a href="asr2.html#brownian-motion"><i class="fa fa-check"></i><b>9.5.1</b> Brownian Motion</a></li>
<li class="chapter" data-level="9.5.2" data-path="asr2.html"><a href="asr2.html#directional-evolution"><i class="fa fa-check"></i><b>9.5.2</b> Directional Evolution</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="asr2.html"><a href="asr2.html#changes-in-the-rate-of-evolution-of-a-trait"><i class="fa fa-check"></i><b>9.6</b> Changes in the rate of evolution of a trait</a></li>
<li class="chapter" data-level="9.7" data-path="asr2.html"><a href="asr2.html#uncertainty"><i class="fa fa-check"></i><b>9.7</b> Uncertainty</a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="asr2.html"><a href="asr2.html#fossils"><i class="fa fa-check"></i><b>9.7.1</b> Fossils</a></li>
<li class="chapter" data-level="9.7.2" data-path="asr2.html"><a href="asr2.html#revisiting-mysticete-body-mass"><i class="fa fa-check"></i><b>9.7.2</b> Revisiting Mysticete Body Mass</a></li>
</ul></li>
<li class="chapter" data-level="9.8" data-path="asr2.html"><a href="asr2.html#further-info-4"><i class="fa fa-check"></i><b>9.8</b> Further info</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="diversification.html"><a href="diversification.html"><i class="fa fa-check"></i><b>10</b> Diversification</a>
<ul>
<li class="chapter" data-level="10.1" data-path="diversification.html"><a href="diversification.html#introduction"><i class="fa fa-check"></i><b>10.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="diversification.html"><a href="diversification.html#pure-birth-model"><i class="fa fa-check"></i><b>10.1.1</b> Pure Birth Model</a></li>
<li class="chapter" data-level="10.1.2" data-path="diversification.html"><a href="diversification.html#the-birth-death-model"><i class="fa fa-check"></i><b>10.1.2</b> The Birth-Death Model</a></li>
<li class="chapter" data-level="10.1.3" data-path="diversification.html"><a href="diversification.html#the-signature-of-extinction"><i class="fa fa-check"></i><b>10.1.3</b> The signature of extinction</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="diversification.html"><a href="diversification.html#estimating-speciation-and-extinction-rate"><i class="fa fa-check"></i><b>10.2</b> Estimating speciation and extinction rate</a></li>
<li class="chapter" data-level="10.3" data-path="diversification.html"><a href="diversification.html#medusa"><i class="fa fa-check"></i><b>10.3</b> MEDUSA</a></li>
<li class="chapter" data-level="10.4" data-path="diversification.html"><a href="diversification.html#rpanda"><i class="fa fa-check"></i><b>10.4</b> RPANDA</a></li>
<li class="chapter" data-level="10.5" data-path="diversification.html"><a href="diversification.html#bamm-bammtools"><i class="fa fa-check"></i><b>10.5</b> BAMM &amp; BAMMtools</a></li>
<li class="chapter" data-level="10.6" data-path="diversification.html"><a href="diversification.html#further-info-5"><i class="fa fa-check"></i><b>10.6</b> Further info</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="diversification2.html"><a href="diversification2.html"><i class="fa fa-check"></i><b>11</b> Trait Dependent Diversification</a>
<ul>
<li class="chapter" data-level="11.1" data-path="diversification2.html"><a href="diversification2.html#binary-traits-bisse"><i class="fa fa-check"></i><b>11.1</b> Binary traits: BiSSE</a></li>
<li class="chapter" data-level="11.2" data-path="diversification2.html"><a href="diversification2.html#multi-state-traits-musse"><i class="fa fa-check"></i><b>11.2</b> Multi-state traits: MuSSE</a></li>
<li class="chapter" data-level="11.3" data-path="diversification2.html"><a href="diversification2.html#quantitative-traits-quasse"><i class="fa fa-check"></i><b>11.3</b> Quantitative traits: QuaSSE</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="diversification2.html"><a href="diversification2.html#quasse-primate-example"><i class="fa fa-check"></i><b>11.3.1</b> QuaSSE primate example</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="w2PGLS.html"><a href="w2PGLS.html"><i class="fa fa-check"></i><b>12</b> Phylogenetic Regression</a>
<ul>
<li class="chapter" data-level="12.1" data-path="w2PGLS.html"><a href="w2PGLS.html#data-4"><i class="fa fa-check"></i><b>12.1</b> Data</a></li>
<li class="chapter" data-level="12.2" data-path="w2PGLS.html"><a href="w2PGLS.html#linear-regression"><i class="fa fa-check"></i><b>12.2</b> Linear Regression</a></li>
<li class="chapter" data-level="12.3" data-path="w2PGLS.html"><a href="w2PGLS.html#phylogenetic-signal"><i class="fa fa-check"></i><b>12.3</b> Phylogenetic Signal</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="w2PGLS.html"><a href="w2PGLS.html#phylogenetic-signal-1"><i class="fa fa-check"></i><b>12.3.1</b> Phylogenetic signal</a></li>
<li class="chapter" data-level="12.3.2" data-path="w2PGLS.html"><a href="w2PGLS.html#caper"><i class="fa fa-check"></i><b>12.3.2</b> caper</a></li>
<li class="chapter" data-level="12.3.3" data-path="w2PGLS.html"><a href="w2PGLS.html#estimating-phylogenetic-signal"><i class="fa fa-check"></i><b>12.3.3</b> Estimating Phylogenetic Signal</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="w2PGLS.html"><a href="w2PGLS.html#phylogenetic-regression"><i class="fa fa-check"></i><b>12.4</b> Phylogenetic Regression</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="w2PGLS.html"><a href="w2PGLS.html#model-checking"><i class="fa fa-check"></i><b>12.4.1</b> Model Checking</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="w2PGLS.html"><a href="w2PGLS.html#conclusion"><i class="fa fa-check"></i><b>12.5</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="pathanalysis.html"><a href="pathanalysis.html"><i class="fa fa-check"></i><b>13</b> Path Analysis</a>
<ul>
<li class="chapter" data-level="13.1" data-path="pathanalysis.html"><a href="pathanalysis.html#pgls-regression"><i class="fa fa-check"></i><b>13.1</b> PGLS regression</a></li>
<li class="chapter" data-level="13.2" data-path="pathanalysis.html"><a href="pathanalysis.html#variance-inflation"><i class="fa fa-check"></i><b>13.2</b> Variance Inflation</a></li>
<li class="chapter" data-level="13.3" data-path="pathanalysis.html"><a href="pathanalysis.html#path-analysis"><i class="fa fa-check"></i><b>13.3</b> Path Analysis</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="pathanalysis.html"><a href="pathanalysis.html#example"><i class="fa fa-check"></i><b>13.3.1</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="pathanalysis.html"><a href="pathanalysis.html#conclusion-1"><i class="fa fa-check"></i><b>13.4</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="convergence.html"><a href="convergence.html"><i class="fa fa-check"></i><b>14</b> Studying Convergence</a>
<ul>
<li class="chapter" data-level="14.1" data-path="convergence.html"><a href="convergence.html#indentifying-convergent-evolution"><i class="fa fa-check"></i><b>14.1</b> Indentifying convergent evolution</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="convergence.html"><a href="convergence.html#surface"><i class="fa fa-check"></i><b>14.1.1</b> SURFACE</a></li>
<li class="chapter" data-level="14.1.2" data-path="convergence.html"><a href="convergence.html#a-super-example"><i class="fa fa-check"></i><b>14.1.2</b> A Super Example</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="convergence.html"><a href="convergence.html#quantifying-convergent-evolution"><i class="fa fa-check"></i><b>14.2</b> Quantifying convergent evolution</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="convergence.html"><a href="convergence.html#the-wheatsheaf-index"><i class="fa fa-check"></i><b>14.2.1</b> The Wheatsheaf Index</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="bibliography.html"><a href="bibliography.html"><i class="fa fa-check"></i><b>15</b> Bibliography</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Comparative Methods Workshops</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="asr2" class="section level1" number="9">
<h1><span class="header-section-number">9</span> Ancestral State Reconstruction II</h1>
<p>Previously, we looked at reconstructing the evolutionary history of binary traits, such as the presence or absence of sexual swellings in macaques, and categorical traits such as the modes of burrowing in carnivores. In this chapter, we’ll be applying the same principles to continuous data.</p>
<p>The logic of ancestral state reconstruction applies equally to continuous traits like body size as it does to categorical traits. Here, we’ll be looking at the evolutionary history of whales, dolphins and porpoises (Cetacea).</p>
<p>As always, check that you have set your working directory!</p>
<div id="data-3" class="section level2" number="9.1">
<h2><span class="header-section-number">9.1</span> Data</h2>
<p>The data we have here is taken from a study of the evolution of cetacean brain and body size <span class="citation">(Montgomery et al. <a href="#ref-Montgomery13" role="doc-biblioref">2013</a>)</span>. The reduced version here contains only body mass and the log transformed body mass for 42 species.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="asr2.html#cb111-1"></a>whale.data &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;whales_data.txt&quot;</span>, <span class="dt">header =</span> T)</span>
<span id="cb111-2"><a href="asr2.html#cb111-2"></a><span class="kw">rownames</span>(whale.data) &lt;-<span class="st"> </span>whale.data<span class="op">$</span>species</span></code></pre></div>
</div>
<div id="tree" class="section level2" number="9.2">
<h2><span class="header-section-number">9.2</span> Tree</h2>
<p>We also have a tree from the <a href="https://10ktrees.nunn-lab.org/" title="10ktrees">10ktrees</a> project <span class="citation">(Arnold et al. <a href="#ref-Arnold10" role="doc-biblioref">2010</a>)</span>. For more information about this website, see chapter 3.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="asr2.html#cb112-1"></a>whale.tree &lt;-<span class="st"> </span><span class="kw">read.nexus</span>(<span class="st">&quot;whales_tree.nex&quot;</span>)</span></code></pre></div>
<p>We need to check the data and tree match up. Get into this habit! It will save you a lot of time and patience.</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="asr2.html#cb113-1"></a><span class="kw">rownames</span>(whale.data) &lt;-<span class="st"> </span>whale.data<span class="op">$</span>species</span>
<span id="cb113-2"><a href="asr2.html#cb113-2"></a>geiger<span class="op">::</span><span class="kw">name.check</span>(whale.tree, whale.data)</span></code></pre></div>
<pre><code>$tree_not_data
 [1] &quot;Balaenoptera_acutorostrata&quot; &quot;Balaenoptera_bonaerensis&quot;  
 [3] &quot;Balaenoptera_edeni&quot;         &quot;Berardius_arnuxii&quot;         
 [5] &quot;Berardius_bairdii&quot;          &quot;Caperea_marginata&quot;         
 [7] &quot;Cephalorhynchus_eutropia&quot;   &quot;Cephalorhynchus_hectori&quot;   
 [9] &quot;Delphinus_capensis&quot;         &quot;Delphinus_tropicalis&quot;      
[11] &quot;Eubalaena_australis&quot;        &quot;Eubalaena_glacialis&quot;       
[13] &quot;Eubalaena_japonica&quot;         &quot;Feresa_attenuata&quot;          
[15] &quot;Hyperoodon_ampullatus&quot;      &quot;Hyperoodon_planifrons&quot;     
[17] &quot;Indopacetus_pacificus&quot;      &quot;Lagenodelphis_hosei&quot;       
[19] &quot;Lagenorhynchus_australis&quot;   &quot;Lagenorhynchus_cruciger&quot;   
[21] &quot;Lissodelphis_peronii&quot;       &quot;Mesoplodon_bidens&quot;         
[23] &quot;Mesoplodon_bowdoini&quot;        &quot;Mesoplodon_carlhubbsi&quot;     
[25] &quot;Mesoplodon_ginkgodens&quot;      &quot;Mesoplodon_grayi&quot;          
[27] &quot;Mesoplodon_hectori&quot;         &quot;Mesoplodon_layardii&quot;       
[29] &quot;Mesoplodon_perrini&quot;         &quot;Mesoplodon_peruvianus&quot;     
[31] &quot;Mesoplodon_stejnegeri&quot;      &quot;Orcaella_brevirostris&quot;     
[33] &quot;Orcaella_heinsohni&quot;         &quot;Peponocephala_electra&quot;     
[35] &quot;Phocoena_dioptrica&quot;         &quot;Phocoena_sinus&quot;            
[37] &quot;Platanista_minor&quot;           &quot;Sousa_chinensis&quot;           
[39] &quot;Stenella_attenuata&quot;         &quot;Stenella_frontalis&quot;        
[41] &quot;Tasmacetus_shepherdi&quot;       &quot;Tursiops_aduncus&quot;          

$data_not_tree
character(0)</code></pre>
<p>Clearly some species need to be dropped from the tree!</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="asr2.html#cb115-1"></a>whale.tree &lt;-<span class="st"> </span><span class="kw">drop.tip</span>(whale.tree, </span>
<span id="cb115-2"><a href="asr2.html#cb115-2"></a>                       geiger<span class="op">::</span><span class="kw">name.check</span>(whale.tree, whale.data)<span class="op">$</span>tree_not_data)</span>
<span id="cb115-3"><a href="asr2.html#cb115-3"></a>geiger<span class="op">::</span><span class="kw">name.check</span>(whale.tree, whale.data)</span></code></pre></div>
<pre><code>[1] &quot;OK&quot;</code></pre>
</div>
<div id="ancestral-state-reconstructions" class="section level2" number="9.3">
<h2><span class="header-section-number">9.3</span> Ancestral State Reconstructions</h2>
<p>Now we’re going to dive in with a reconstruction. We are using <strong>phytools</strong> for this analysis so we should load the package and create a named data vector <span class="citation">(Revell <a href="#ref-phytools" role="doc-biblioref">2012</a>)</span>.</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="asr2.html#cb117-1"></a><span class="kw">require</span>(phytools)</span>
<span id="cb117-2"><a href="asr2.html#cb117-2"></a>x &lt;-<span class="st"> </span>whale.data<span class="op">$</span>log.body.mass</span>
<span id="cb117-3"><a href="asr2.html#cb117-3"></a><span class="kw">names</span>(x) &lt;-<span class="st"> </span>whale.data<span class="op">$</span>species</span></code></pre></div>
<p>The function we need is called <strong>fastAnc</strong> and it returns the ancestral states in a simple list.</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="asr2.html#cb118-1"></a>ancstates &lt;-<span class="st"> </span><span class="kw">fastAnc</span>(<span class="dt">tree =</span> whale.tree,   <span class="co">#Our phylogeny</span></span>
<span id="cb118-2"><a href="asr2.html#cb118-2"></a>                     x,                   <span class="co">#Our data vector</span></span>
<span id="cb118-3"><a href="asr2.html#cb118-3"></a>                     <span class="dt">CI =</span> <span class="ot">TRUE</span>)           <span class="co">#Estimate 95% confidence intervals</span></span>
<span id="cb118-4"><a href="asr2.html#cb118-4"></a>ancstates</span></code></pre></div>
<pre><code>Ancestral character estimates using fastAnc:
      43       44       45       46       47       48       49       50 
6.422936 7.205471 7.440591 7.465284 7.456463 7.511707 6.248774 6.097254 
      51       52       53       54       55       56       57       58 
6.044864 6.078069 5.983733 5.962172 5.641527 5.423179 5.255812 5.204571 
      59       60       61       62       63       64       65       66 
5.225028 5.260263 4.960018 4.901903 4.871755 4.888973 5.503471 5.567067 
      67       68       69       70       71       72       73       74 
5.710190 5.130854 4.989830 5.001555 4.960103 4.976035 5.039423 5.403331 
      75       76       77       78       79       80       81       82 
5.850745 4.870560 4.871380 4.883752 5.590679 5.292187 6.267476 5.540614 

Lower &amp; upper 95% CIs:
      lower    upper
43 5.745860 7.100012
44 6.599516 7.811426
45 7.009526 7.871657
46 7.037792 7.892775
47 7.023487 7.889440
48 7.078101 7.945312
49 5.617637 6.879912
50 5.480639 6.713870
51 5.396996 6.692732
52 5.495449 6.660689
53 5.489021 6.478445
54 5.474786 6.449558
55 4.977189 6.305864
56 4.818460 6.027899
57 4.833079 5.678546
58 4.834286 5.574857
59 4.930739 5.519317
60 4.970172 5.550353
61 4.679687 5.240349
62 4.656292 5.147513
63 4.621817 5.121692
64 4.661301 5.116645
65 5.175817 5.831126
66 5.231290 5.902844
67 5.455762 5.964619
68 4.810518 5.451190
69 4.731256 5.248405
70 4.760819 5.242292
71 4.767162 5.153044
72 4.800446 5.151624
73 4.692067 5.386779
74 4.792073 6.014589
75 5.352644 6.348847
76 4.380205 5.360915
77 4.449659 5.293101
78 4.482168 5.285335
79 4.892863 6.288496
80 4.417990 6.166384
81 5.492347 7.042604
82 4.959783 6.121445</code></pre>
<p>To get an idea of what these results show, we should probably plot it. The <strong>nodelabels</strong> function maps the ancestral states listed in our <strong>ancstates</strong> object onto the nodes of the tree which are listed in the same order.</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="asr2.html#cb120-1"></a><span class="kw">plot</span>(whale.tree, <span class="dt">cex =</span> <span class="fl">.8</span>, <span class="dt">label.offset =</span> <span class="fl">.01</span>, <span class="dt">no.margin =</span> <span class="ot">TRUE</span>)</span>
<span id="cb120-2"><a href="asr2.html#cb120-2"></a><span class="kw">nodelabels</span>(<span class="kw">round</span>(ancstates<span class="op">$</span>ace, <span class="dt">digits =</span> <span class="dv">2</span>), <span class="dt">cex =</span> <span class="fl">.67</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-119-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>As is often the case, there are better ways to plot this information! The function <strong>contMap</strong> calls <strong>fastAnc</strong> and then maps the history of the trait onto the tree as a heatmap. This is a much clearer plot.</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="asr2.html#cb121-1"></a><span class="kw">contMap</span>(whale.tree, x, <span class="dt">fsize =</span> <span class="fl">.7</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-120-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="bayestraits" class="section level2" number="9.4">
<h2><span class="header-section-number">9.4</span> BayesTraits</h2>
<p>Simply reconstructing the history of a trait can be very interesting. See some papers by Montgomery <em>et al</em>. <span class="citation">(<a href="#ref-Montgomery10" role="doc-biblioref">2010</a>, <a href="#ref-Montgomery13" role="doc-biblioref">2013</a>)</span> for just a few great examples. However, this methodology is not limited to simply estimating the past.</p>
<p>Most of what we are going to do here could probably be acheived in R either with existing packages or some clever coding. However, the standard package for several analyses has been <a href="http://www.evolution.rdg.ac.uk/BayesTraitsV3.0.2/BayesTraitsV3.0.2.html" title="BT">BayesTraits</a> for some time.</p>
<p>BayesTraits is a command line program, which can make it kind of intimidating. Actually (like R), it’s relatively easy to use but can take some getting used to. Fortunately, <a href="https://www.randigriffin.com/" title="Randi Griffin">Randi Griffin</a> has written an excellent R package <strong>btw</strong> that can operate the program from within R.</p>
<p>It’s worth noting at this point that <strong>btw</strong> is not written to run BayesTraits for you so that you don’t have to understand the program. Randi states very clearly that the package is purely for optimising workflow. In other words, this allows you to have all your data, results and code in one place. You still need to understand how to use the program. Fortunately the <a href="http://www.evolution.rdg.ac.uk/BayesTraitsV3.0.2/Files/BayesTraitsV3.0.2Manual.pdf" title="manual">manual</a> is very detailed.</p>
<p>First up, download <a href="http://www.evolution.rdg.ac.uk/BayesTraitsV3.0.2/BayesTraitsV3.0.2.html" title="BT">BayesTraits</a> version 3 for your operating system.</p>
<p><strong>IMPORTANT!</strong> BayesTraits output files will be written into your working directory. They will overwrite any files with the same name so don’t have any files called “data.txt”, “tree.nex” or “inputfile.txt” in this directory unless you are ok with losing them.</p>
<p>Next, we need to install <strong>btw</strong>. This isn’t a CRAN archived package so we’ll be installing directly from Randi Griffin’s GitHub. Once installed, we can use BayesTraits from within R!</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="asr2.html#cb122-1"></a><span class="kw">install.packages</span>(<span class="st">&quot;devtools&quot;</span>)</span>
<span id="cb122-2"><a href="asr2.html#cb122-2"></a><span class="kw">library</span>(devtools)</span>
<span id="cb122-3"><a href="asr2.html#cb122-3"></a><span class="kw">install_github</span>(<span class="st">&quot;rgriff23/btw&quot;</span>)</span>
<span id="cb122-4"><a href="asr2.html#cb122-4"></a><span class="kw">library</span>(btw)</span></code></pre></div>
<p>There are some important differences in how R and BayesTraits read data that need to be summarised here.</p>
<ul>
<li>The first column of your data must contain species names.</li>
<li>Species names must match exactly between tree and data (but don’t worry about the order).</li>
<li>No spaces in species names.</li>
<li>Discrete characters have to be of class character or factor (between 0-9) and NOT integer.</li>
<li>Ambiguous discrete characters can be represented as 01.</li>
<li>Missing data must be represented as - rather than NA.</li>
</ul>
<p>BayesTraits consists of modules (see <a href="http://www.evolution.rdg.ac.uk/BayesTraitsV3.0.2/Files/BayesTraitsV3.0.2Manual.pdf" title="manual">manual</a> for details) that are numbered and can be called up for different analyses.</p>
<p>If you can’t get R and Bayestraits to play nicely together, you may want to consider using Bayestraits directly from the command prompt (Windows) or terminal (Mac). It’s fairly straightforward once you’ve got the hang of it so be patient. Alternatively, all of this can be done with R packages like ape <span class="citation">(Paradis and Schliep <a href="#ref-ape" role="doc-biblioref">2018</a>)</span>, geiger <span class="citation">(Harmon et al. <a href="#ref-geiger" role="doc-biblioref">2008</a>)</span> and phytools <span class="citation">(Revell <a href="#ref-phytools" role="doc-biblioref">2012</a>)</span> amongst others.</p>
</div>
<div id="modelling-evolution" class="section level2" number="9.5">
<h2><span class="header-section-number">9.5</span> Modelling Evolution</h2>
<p>If we have some data about traits across a group of animals and an associated tree, we may want to ask about how that trait has evolved over time. For this we can compare the trait to models of evolutionary change.</p>
<div id="brownian-motion" class="section level3" number="9.5.1">
<h3><span class="header-section-number">9.5.1</span> Brownian Motion</h3>
<p>Brownian motion (BM) is the most commonly used model of evolutionary change. In some ways, it can represent a kind of <em>null model</em> but do not confuse this! It doesn’t mean nothing is changing or that evolution is not taking place.</p>
<p>Brownian motion assumes three things;</p>
<ul>
<li>Evolutionary changes in a trait are randomly distributed around a mean of 0.</li>
<li>Evolutionary changes in a trait are independent of previous changes and changes on other branches.</li>
<li>Larger changes are more likely to occur on longer branches.</li>
</ul>
<p>All this means that BM is a <em>random walk</em> model in which the trait varies along the branches essentially at random.</p>
<p>We can use BayesTraits (via R) to model the evolution of body size in cetaceans with the assumption of Brownian motion. First we need to isolate our variables into a data table for <strong>btw</strong>. The way to do this is quite simple. We can simply extract the two columns we need (1 and 2) into a new object.</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="asr2.html#cb123-1"></a>BT.data &lt;-<span class="st"> </span>whale.data[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)]</span>
<span id="cb123-2"><a href="asr2.html#cb123-2"></a><span class="kw">rownames</span>(BT.data) &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb123-3"><a href="asr2.html#cb123-3"></a><span class="kw">head</span>(BT.data)</span></code></pre></div>
<pre><code>                species log.body.mass
1       Kogia_breviceps      5.523746
2            Kogia_sima      5.226600
3      Physeter_catodon      7.573065
4  Platanista_gangetica      4.775465
5 Delphinapterus_leucas      5.803457
6     Monodon_monoceros      6.198198</code></pre>
<p>This first analysis corresponds to <strong>Continuous: Random Walk Model A ML</strong> in the BayesTraits <a href="http://www.evolution.rdg.ac.uk/BayesTraitsV3.0.2/Files/BayesTraitsV3.0.2Manual.pdf" title="manual">manual</a>. We can see from the manual that the commands to run this are “4 1 Run”. You need to be familiar with BayesTraits to interpret this so the first time you do it, you may want to do it in BayesTraits directly (via the command prompt or terminal). In essence, BayesTraits asks us questions and provides us with options for what we want it to do and <strong>4, 1, Run</strong> are the options to run this analysis.</p>
<p>Given that we know what we want to do ahead of time, we can enter the commands into a command vector in R. To run these commands through BayesTraits, R will write them into a text file so BayesTraits can interpret them when needed. Note that you don’t need to enter <strong>Run</strong> into this vector as <strong>btw</strong> will take care of that for us.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="asr2.html#cb125-1"></a>command_vec1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;4&quot;</span>, <span class="st">&quot;1&quot;</span>)</span></code></pre></div>
<p>Note that if you have nodelabels in your tree, there will be an error when running BayesTraits. You can remove nodelabels without effecting the structure of your tree like this.</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="asr2.html#cb126-1"></a>whale.tree<span class="op">$</span>node.label &lt;-<span class="st"> </span><span class="ot">NULL</span></span></code></pre></div>
<p>I have a path on my desktop just for BayesTraits analyses. Remember that there must be a copy of BayesTraitsV3 stored here. That’s all you need as the output will be read back into R by <strong>btw</strong>. You also should remember to change your working directory back if you are finished with BayesTraits. In this chunk, I’ve saved the existing directory at the start and reset it immediately after the analysis is completed.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="asr2.html#cb127-1"></a>wd.reset &lt;-<span class="st"> </span><span class="kw">getwd</span>()</span>
<span id="cb127-2"><a href="asr2.html#cb127-2"></a><span class="kw">setwd</span>(<span class="st">&quot;~/Desktop/BayesTraits&quot;</span>)</span>
<span id="cb127-3"><a href="asr2.html#cb127-3"></a>m1 &lt;-<span class="st"> </span><span class="kw">bayestraits</span>(<span class="dt">data =</span> BT.data, <span class="dt">tree =</span> whale.tree, <span class="dt">commands =</span> command_vec1)</span>
<span id="cb127-4"><a href="asr2.html#cb127-4"></a><span class="kw">setwd</span>(wd.reset)</span></code></pre></div>
<p>On we go! The object that should have appeared in your R environment contains all the outputs you need from BayesTraits. Let’s have a look at the <strong>results</strong> component of the <strong>Log</strong>.</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="asr2.html#cb128-1"></a>m1<span class="op">$</span>Log<span class="op">$</span>results</span></code></pre></div>
<pre><code>  Tree.No       Lh  Alpha.1 Sigma.2.1
1       1 -31.9823 6.422936  6.315406</code></pre>
<p>These results give us the Log likelihood (<strong>Lh</strong>), the reconstructed ancestral node (<strong>Alpha.1</strong>) and the phylogenetically corrected variance of the data (<strong>Sigma.2.1</strong>). The important thing to look at here is the log likelihood. We will use that to compare the BM model to other models.</p>
</div>
<div id="directional-evolution" class="section level3" number="9.5.2">
<h3><span class="header-section-number">9.5.2</span> Directional Evolution</h3>
<p>So far we’ve looked at the random walk model of evolution. In reality, what we are usually interested in is deviations from the random walk model. We can investigate this using similar methods, but with a <strong>directional</strong> model.</p>
<p>An example of a case when we might be interested in a directional model is Cope’s rule <span class="citation">(Kingsolver and Pfennig <a href="#ref-Kingsolver04" role="doc-biblioref">2004</a>, Hone and Benton <a href="#ref-Hone05" role="doc-biblioref">2005</a>)</span>. Cope’s rule states that over time, lineages tend to have larger body sizes. So basically, on average animals tend to get bigger over evolutionary time.</p>
Let’s see if we can detect a trend in cetacean body mass. For this analysis, we need a non-ultrametric tree (a phylogram rather than a chronogram). Luckily that’s what we already have. The branch lengths here describe evolutionary distance in terms of genetic change and so shorter branches indicate fewer genetic changes.
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-128"></span>
<img src="bookdown-demo_files/figure-html/unnamed-chunk-128-1.png" alt="Phylogenetic tree of 42 species of cetcaeans with branch lengths proportional to molecular change." width="672" />
<p class="caption">
Figure 9.1: Phylogenetic tree of 42 species of cetcaeans with branch lengths proportional to molecular change.
</p>
</div>
<p>We’re using BayesTraits again so the first step is to get our data into the right format.</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="asr2.html#cb130-1"></a>BT.data &lt;-<span class="st"> </span>whale.data[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)]</span>
<span id="cb130-2"><a href="asr2.html#cb130-2"></a><span class="kw">rownames</span>(BT.data) &lt;-<span class="st"> </span><span class="ot">NULL</span></span></code></pre></div>
<p>As before, we run the random walk (BM) model first. Remember we need to set the working directory to a path where BayesTraits is stored.</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="asr2.html#cb131-1"></a><span class="kw">setwd</span>(<span class="st">&quot;~/Desktop/BayesTraits&quot;</span>)</span>
<span id="cb131-2"><a href="asr2.html#cb131-2"></a>RW.commands &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;4&quot;</span>, <span class="st">&quot;1&quot;</span>)</span>
<span id="cb131-3"><a href="asr2.html#cb131-3"></a>RWmod &lt;-<span class="st"> </span><span class="kw">bayestraits</span>(BT.data, whale.tree, RW.commands)</span>
<span id="cb131-4"><a href="asr2.html#cb131-4"></a>RWmod<span class="op">$</span>Log<span class="op">$</span>results</span></code></pre></div>
<pre><code>  Tree.No       Lh  Alpha.1 Sigma.2.1
1       1 -31.9823 6.422936  6.315406</code></pre>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="asr2.html#cb133-1"></a><span class="kw">setwd</span>(wd.reset)</span></code></pre></div>
<p>The directional model takes a different set of commands.</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="asr2.html#cb134-1"></a><span class="kw">setwd</span>(<span class="st">&quot;~/Desktop/BayesTraits&quot;</span>)</span>
<span id="cb134-2"><a href="asr2.html#cb134-2"></a>D.commands &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;5&quot;</span>, <span class="st">&quot;1&quot;</span>)</span>
<span id="cb134-3"><a href="asr2.html#cb134-3"></a>Dmod &lt;-<span class="st"> </span><span class="kw">bayestraits</span>(BT.data, whale.tree, D.commands)</span>
<span id="cb134-4"><a href="asr2.html#cb134-4"></a>Dmod<span class="op">$</span>Log<span class="op">$</span>results</span></code></pre></div>
<pre><code>  Tree.No        Lh  Alpha.1    Beta.1 Sigma.2.1
1       1 -30.22462 7.951217 -12.37922  5.808331</code></pre>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="asr2.html#cb136-1"></a><span class="kw">setwd</span>(wd.reset)</span></code></pre></div>
<p>Now we need to compare these models! What he have so far is two models and a log likelihood assigned to each. This means we can compare them using a <strong>likelihood ratio test</strong>. The general formula for an LR test is;</p>
<p><span class="math display">\[\text{LR}=2\times(\text{Lh}_{\text{ Model B}} - \text{Lh}_{\text{ Model A}})\]</span></p>
<p>The result is the <strong>likelhood ratio statistic</strong> (LR) which is asymptotically <span class="math inline">\(\chi^2\)</span> distributed with degrees of freedom equal to the difference in the number of parameters between the models. Model A has 1 parameter (the root value) and model B has 2 (the root and the direction of change) so the degrees of freedom are 1.</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="asr2.html#cb137-1"></a><span class="dv">2</span><span class="op">*</span>(Dmod<span class="op">$</span>Log<span class="op">$</span>results<span class="op">$</span>Lh[<span class="dv">1</span>] <span class="op">-</span><span class="st"> </span>RWmod<span class="op">$</span>Log<span class="op">$</span>results<span class="op">$</span>Lh[<span class="dv">1</span>])</span></code></pre></div>
<pre><code>[1] 3.515352</code></pre>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="asr2.html#cb139-1"></a><span class="dv">1</span><span class="op">-</span><span class="kw">pchisq</span>(<span class="fl">3.515352</span>, <span class="dt">df =</span> <span class="dv">1</span>) </span></code></pre></div>
<pre><code>[1] 0.06080274</code></pre>
<p>Note: pchisq gives the proportion of the distribution to the left of the value. To test if the model is better than the null model, we use 1 - pchisq.</p>
<p>The <strong>btw</strong> package has a function that will do all this for us. Be careful with interpretation though. Note that the p-value is different. Take this away from 1 and you have your p-value as above.</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="asr2.html#cb141-1"></a><span class="kw">lrtest</span>(RWmod, Dmod)</span></code></pre></div>
<pre><code>  model1.Lh model2.Lh   LRstat      pval
1  -31.9823 -30.22462 3.515352 0.9391973</code></pre>
<p>So what have we got here? Well we have tested two models of the evolution of body size in cetacea. The first is a random walk (Brownian motion) model of evolution in which we have estimated two parameters. The second is a directional model in which we have estimated 3 parameters. Model comparison showed no significant difference between them (LR = 3.52, p = 0.06) and so we should favour the simpler, 2 parameter model. Thus we have no evidence for a directional trend in cetacean body mass evolution.</p>
</div>
</div>
<div id="changes-in-the-rate-of-evolution-of-a-trait" class="section level2" number="9.6">
<h2><span class="header-section-number">9.6</span> Changes in the rate of evolution of a trait</h2>
<p>Often when investigating the evolution of a continuous trait, we might have reason to suggest that in some lineages, the rate of evolution of that trait changed.
<img src="bookdown-demo_files/figure-html/unnamed-chunk-134-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Let’s say we have a hypothesis that says the rate of change of body mass changed at the root of mysticetes (node 44). We can paint that onto the tree for demonstration using <strong>paintSubTree</strong> and <strong>plotSimmap</strong> in <strong>phytools</strong> <span class="citation">(Revell <a href="#ref-phytools" role="doc-biblioref">2012</a>)</span>.</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="asr2.html#cb143-1"></a><span class="kw">require</span>(phytools)</span>
<span id="cb143-2"><a href="asr2.html#cb143-2"></a>tree1 &lt;-<span class="st"> </span><span class="kw">paintSubTree</span>(whale.tree, <span class="dv">44</span>, <span class="st">&quot;2&quot;</span>)</span>
<span id="cb143-3"><a href="asr2.html#cb143-3"></a><span class="kw">plotSimmap</span>(tree1, <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">fsize =</span> <span class="fl">0.7</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-135-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Now we can run the test. Here the function <strong>brownie.lite</strong> in <strong>phytools</strong> compares the single rate model to the multi-rate model we have specified!</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="asr2.html#cb144-1"></a>x &lt;-<span class="st"> </span>whale.data<span class="op">$</span>log.body.mass</span>
<span id="cb144-2"><a href="asr2.html#cb144-2"></a><span class="kw">names</span>(x) &lt;-<span class="st"> </span>whale.data<span class="op">$</span>species</span>
<span id="cb144-3"><a href="asr2.html#cb144-3"></a>fit &lt;-<span class="st"> </span><span class="kw">brownie.lite</span>(tree1, x)</span>
<span id="cb144-4"><a href="asr2.html#cb144-4"></a>fit</span></code></pre></div>
<pre><code>ML single-rate model:
    s^2 se  a   k   logL
value   6.165   1.3453  6.4229  2   -31.9823    

ML multi-rate model:
    s^2(1)  se(1)   s^2(2)  se(2)   a   k   logL    
value   7.1119  1.6786  1.2663  0.8687  6.6116  3   -30.475

P-value (based on X^2): 0.0825 

R thinks it has found the ML solution.</code></pre>
<p>Here we’ve found no evidence of a regime shift in mysticete cetaceans (p = 0.083).</p>
</div>
<div id="uncertainty" class="section level2" number="9.7">
<h2><span class="header-section-number">9.7</span> Uncertainty</h2>
<p>If you are familiar with cetaceans and their evolutionary history, you might be surprised by our findings so far in this chapter. The prevailing state of knowledge suggests that cetaceans have evolved large body sizes since the transition to the water of an approximately dog-sized ancestor at the root of our tree. Given what we know about the fossil record of cetacea, we would expect to detect an increase in body size over the tree. To solve this puzzle, we need to look at what information we provided our analysis with.</p>
<p>As the old saying goes, <em>if you put garbage in, you’ll get garbage out</em> and this seems to apply here. For example, let’s look closely at our reconstructions. You can see here that both reconstructions have estimated the mass of the ancestor of cetaceans. Remember that these are log transformed data so we have to transform them back if we want to get a straightforward measurement of mass.</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="asr2.html#cb146-1"></a><span class="dv">10</span><span class="op">^</span>(RWmod<span class="op">$</span>Log<span class="op">$</span>results<span class="op">$</span>Alpha<span class="fl">.1</span>)</span></code></pre></div>
<pre><code>[1] 2648111</code></pre>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="asr2.html#cb148-1"></a><span class="dv">10</span><span class="op">^</span>(Dmod<span class="op">$</span>Log<span class="op">$</span>results<span class="op">$</span>Alpha<span class="fl">.1</span>)</span></code></pre></div>
<pre><code>[1] 89375216</code></pre>
<p>So depending on our model of evolution the ancestor was either 2,648.1 kg or 89,375.2 kg. A big difference between models so which one we choose really matters.</p>
<p>This is even more of a problem when we look at the fossil record of cetaceans. <em>Indohyus</em> (Raoellidae) is thought to be the species that most closely represents the transition to the water by cetacean ancestors <span class="citation">(Thewissen et al. <a href="#ref-Thewissen09" role="doc-biblioref">2009</a>)</span> and its mass is estimated at around 10kg. An early species of cetacean called <em>Pakicetus</em> was estimated at around 45kg. So we are orders of magnitude away from what the fossil record shows us!</p>
<p>This problem is well understood in phylogenetic comparative methods. In fact, all methods of ancestral state reconstruction perform very poorly when compared to what we know from the fossil record <span class="citation">(Webster and Purvis <a href="#ref-Webster02" role="doc-biblioref">2002</a>)</span>. As you might expect, the deeper into your tree you try to estimate an ancestral state, the greater the uncertainty. This is especially clear when you look at estimating the root <span class="citation">(Gascuel and Steel <a href="#ref-Gascuel14" role="doc-biblioref">2014</a>)</span>. The solution is to incorporate fossil data in the analysis <span class="citation">(Slater et al. <a href="#ref-Slater12" role="doc-biblioref">2012</a>)</span>.</p>
<div id="fossils" class="section level3" number="9.7.1">
<h3><span class="header-section-number">9.7.1</span> Fossils</h3>
<p>To demonstrate the importance of fossil data, let’s take a closer look at the evolution of body size in cetaceans. With <strong>fastAnc</strong>, we found a mass of around 2,650kg for the root of the cetaceans.</p>
<p>The package <strong>RRphylo</strong> <span class="citation">(Castiglione et al. <a href="#ref-rrphylo" role="doc-biblioref">2018</a>)</span> contains data on fossil and living cetaceans <span class="citation">(Serio et al. <a href="#ref-Serio19" role="doc-biblioref">2019</a>)</span>. Using these data, we can hopefully perform a more rigorous ancestral state reconstruction <span class="citation">(Castiglione et al. <a href="#ref-Castiglione20" role="doc-biblioref">2020</a>)</span>. Note that the values here differ between datasets because the previous dataset used a log10 transformation whereas this one uses a natural log transformation!</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="asr2.html#cb150-1"></a><span class="kw">library</span>(RRphylo)</span>
<span id="cb150-2"><a href="asr2.html#cb150-2"></a><span class="kw">data</span>(<span class="st">&quot;DataCetaceans&quot;</span>)</span>
<span id="cb150-3"><a href="asr2.html#cb150-3"></a>DataCetaceans<span class="op">$</span>treecet -&gt;<span class="st"> </span>treecet</span>
<span id="cb150-4"><a href="asr2.html#cb150-4"></a>DataCetaceans<span class="op">$</span>masscet -&gt;<span class="st"> </span>masscet</span></code></pre></div>
<p>The <strong>RRphylo</strong> function performs a variant of ancestral state reconstruction called <strong>phylogenetic ridge regression</strong> <span class="citation">(Castiglione et al. <a href="#ref-Castiglione20" role="doc-biblioref">2020</a>)</span>.</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="asr2.html#cb151-1"></a>RR &lt;-<span class="st"> </span><span class="kw">RRphylo</span>(treecet, masscet)</span></code></pre></div>
<p>RRphylo returns a lot of information as a list. Included in this list is the <strong>tree</strong> used (useful for plotting) and <strong>aces</strong> which contains the estimates for the traits at the nodes.</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="asr2.html#cb152-1"></a><span class="kw">plot</span>(RR<span class="op">$</span>tree, <span class="dt">cex =</span> <span class="fl">.4</span>, <span class="dt">label.offset =</span> <span class="fl">.5</span>, <span class="dt">no.margin =</span> <span class="ot">TRUE</span>)</span>
<span id="cb152-2"><a href="asr2.html#cb152-2"></a><span class="kw">nodelabels</span>(<span class="kw">round</span>(RR<span class="op">$</span>aces, <span class="dt">digits =</span> <span class="dv">1</span>), <span class="dt">cex =</span> <span class="fl">.5</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-140-1.png" width="864" style="display: block; margin: auto;" /></p>
<p>Using this reconstruction, we can extract the mass of the root. Remember that we need <strong>exp</strong> to calculate the untransformed value rather than raising to the power of 10 because of the natural log transformation.</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="asr2.html#cb153-1"></a><span class="kw">exp</span>(RR<span class="op">$</span>aces[[<span class="dv">1</span>]])</span></code></pre></div>
<pre><code>[1] 727063.9</code></pre>
<p>So our new estimate of the mass of the ancestor of cetaceans is 727.1kg. This is much closer to the estimated mass of early archeocete cetaceans like <em>Ambulocetus natans</em> at about 430kg and <em>Indocetus ramani</em> at around 630kg.</p>
<p>If we still aren’t satisfied that we have included the best information we have available, we can actually <em>fossilise</em> a node by passing a named list of ancestral states to the <strong>RRphylo</strong> function. Following the example of Castiglione <em>et al</em>. <span class="citation">(<a href="#ref-Castiglione20" role="doc-biblioref">2020</a>)</span>, we can set the node of the ancestor of mysticetes to a known mass. Here we are assuming that the most recent common ancestor of all mysticetes can be represented by the species <em>Mystacodon selenensis</em> which weighed arond 150kg. Also we need to know that this ancestor is represented by the node labelled 128 in our tree object.</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="asr2.html#cb155-1"></a>x &lt;-<span class="st"> </span><span class="kw">log</span>(<span class="dv">150000</span>)</span>
<span id="cb155-2"><a href="asr2.html#cb155-2"></a><span class="kw">names</span>(x) &lt;-<span class="st"> &quot;128&quot;</span></span></code></pre></div>
<p>Now we can pass this state to the argument <strong>aces</strong> in <strong>RRphylo</strong> and the analysis will hold node 128 at the value we have set. You should be able to see that in the following plot, the ancestor of mysticetes is reconstructed as 11.9 rather than 12.9 in the previous reconstruction.</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="asr2.html#cb156-1"></a>RR2 &lt;-<span class="st"> </span><span class="kw">RRphylo</span>(treecet, masscet, <span class="dt">aces =</span> x)</span>
<span id="cb156-2"><a href="asr2.html#cb156-2"></a><span class="kw">plot</span>(RR2<span class="op">$</span>tree, <span class="dt">cex =</span> <span class="fl">.4</span>, <span class="dt">label.offset =</span> <span class="fl">.5</span>, <span class="dt">no.margin =</span> <span class="ot">TRUE</span>)</span>
<span id="cb156-3"><a href="asr2.html#cb156-3"></a><span class="kw">nodelabels</span>(<span class="kw">round</span>(RR2<span class="op">$</span>aces, <span class="dt">digits =</span> <span class="dv">1</span>), <span class="dt">cex =</span> <span class="fl">.5</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-143-1.png" width="864" style="display: block; margin: auto;" /></p>
<p>Hopefully you can see that the more fossil information you include in your reconstructions, the more reliable they are.</p>
</div>
<div id="revisiting-mysticete-body-mass" class="section level3" number="9.7.2">
<h3><span class="header-section-number">9.7.2</span> Revisiting Mysticete Body Mass</h3>
<p>In using the fossil data we have added in here, Castiglione <em>et al</em>. <span class="citation">(<a href="#ref-Castiglione20" role="doc-biblioref">2020</a>)</span> demonstrated that mysticetes actually do conform to Cope’s rule because they have an increasing trend in body size over time. This shows just how important adding in fossil data can be if you want the full picture.</p>
<p>This seems to suggest that we should also find a regime shift in mysticetes. Let’s have a closer look. We begin again by painting the tree at the specific node leading to mysticetes.</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="asr2.html#cb157-1"></a><span class="kw">require</span>(phytools)</span>
<span id="cb157-2"><a href="asr2.html#cb157-2"></a>tree2 &lt;-<span class="st"> </span><span class="kw">paintSubTree</span>(treecet, <span class="dv">128</span>, <span class="st">&quot;2&quot;</span>)</span>
<span id="cb157-3"><a href="asr2.html#cb157-3"></a><span class="kw">plotSimmap</span>(tree2, <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">fsize =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-144-1.png" width="864" style="display: block; margin: auto;" /></p>
<p>Next we run <strong>brownie.lite</strong> on our expanded dataset.</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="asr2.html#cb158-1"></a>fit &lt;-<span class="st"> </span><span class="kw">brownie.lite</span>(tree2, masscet)</span>
<span id="cb158-2"><a href="asr2.html#cb158-2"></a>fit</span></code></pre></div>
<pre><code>ML single-rate model:
    s^2 se  a   k   logL
value   0.2047  0.0265  13.2057 2   -178.7922   

ML multi-rate model:
    s^2(1)  se(1)   s^2(2)  se(2)   a   k   logL    
value   0.176   0.0245  0.4012  0.147   13.2056 3   -176.0958

P-value (based on X^2): 0.0202 

R thinks it has found the ML solution.</code></pre>
<p>There you have it! We can now say that we have evidence in favour of a regime shift in mysticete body size (p = 0.02).</p>
</div>
</div>
<div id="further-info-4" class="section level2" number="9.8">
<h2><span class="header-section-number">9.8</span> Further info</h2>
<p>We’ve only just scratched the surface of what is possible with ancestral state reconstruction. For some background reading, have a look at chapter 4 of <em>The comparative approach in evolutionary anthropology and biology</em> <span class="citation">(Nunn <a href="#ref-Nunn11" role="doc-biblioref">2011</a>)</span>.</p>

</div>
</div>
<h3> Bibliography</h3>
<div id="refs" class="references">
<div id="ref-Arnold10">
<p>Arnold, C., Matthews, L.J., and Nunn, C.L. (2010) ‘The 10kTrees Website: A New Online Resource for Primate Phylogeny’. <em>Evolutionary Anthropology: Issues, News, and Reviews</em> [online] 19 (3), 114–118. available from &lt;<a href="https://doi.org/10.1002/evan.20251">https://doi.org/10.1002/evan.20251</a>&gt;</p>
</div>
<div id="ref-Castiglione20">
<p>Castiglione, S., Serio, C., Mondanaro, A., Melchionna, M., Carotenuto, F., Di Febbraro, M., Profico, A., Tamagnini, D., and Raia, P. (2020) ‘Ancestral State Estimation with Phylogenetic Ridge Regression’. <em>Evolutionary Biology</em> [online] available from &lt;<a href="https://doi.org/10.1007/s11692-020-09505-x">https://doi.org/10.1007/s11692-020-09505-x</a>&gt;</p>
</div>
<div id="ref-rrphylo">
<p>Castiglione, S., Tesone, G., Piccolo, M., Melchionna, M., Mondanaro, A., Serio, C., Febbraro, M.D., and Raia, P. (2018) ‘A New Method for Testing Evolutionary Rate Variation and Shifts in Phenotypic Evolution.’ <em>Methods in Ecology and Evolution</em> [online] 9, 974–983. available from &lt;<a href="https://besjournals.onlinelibrary.wiley.com/doi/full/10.1111/2041-210X.12954">https://besjournals.onlinelibrary.wiley.com/doi/full/10.1111/2041-210X.12954</a>&gt;</p>
</div>
<div id="ref-Gascuel14">
<p>Gascuel, O. and Steel, M. (2014) ‘Predicting the Ancestral Character Changes in a Tree Is Typically Easier Than Predicting the Root State’. <em>Systematic Biology</em> [online] 63 (3), 421–435. available from &lt;<a href="https://doi.org/10.1093/sysbio/syu010">https://doi.org/10.1093/sysbio/syu010</a>&gt;</p>
</div>
<div id="ref-geiger">
<p>Harmon, L., Weir, J., Brock, C., Glor, R., and Challenger, W. (2008) ‘GEIGER: Investigating Evolutionary Radiations’. <em>Bioinformatics</em> 24, 129–131</p>
</div>
<div id="ref-Hone05">
<p>Hone, D.W.E. and Benton, M.J. (2005) ‘The Evolution of Large Size: How Does Cope’s Rule Work?’ <em>Trends in Ecology &amp; Evolution</em> [online] 20 (1), 4–6. available from &lt;<a href="https://liverpool.idm.oclc.org/login?url=https://search.ebscohost.com/login.aspx?direct=true&amp;db=edselp&amp;AN=S0169534704003143&amp;site=eds-live&amp;scope=site">https://liverpool.idm.oclc.org/login?url=https://search.ebscohost.com/login.aspx?direct=true&amp;db=edselp&amp;AN=S0169534704003143&amp;site=eds-live&amp;scope=site</a>&gt;</p>
</div>
<div id="ref-Kingsolver04">
<p>Kingsolver, J.G. and Pfennig, D.W. (2004) ‘Individual-Level Selection as a Cause of Cope’s Rule of Phyletic Size Increase’. <em>Evolution</em> [online] 58 (7), 1608. available from &lt;<a href="https://liverpool.idm.oclc.org/login?url=https://search.ebscohost.com/login.aspx?direct=true&amp;db=edsjsr&amp;AN=edsjsr.3449385&amp;site=eds-live&amp;scope=site">https://liverpool.idm.oclc.org/login?url=https://search.ebscohost.com/login.aspx?direct=true&amp;db=edsjsr&amp;AN=edsjsr.3449385&amp;site=eds-live&amp;scope=site</a>&gt;</p>
</div>
<div id="ref-Montgomery10">
<p>Montgomery, S.H., Capellini, I., Barton, R.A., and Mundy, N.I. (2010) ‘Reconstructing the Ups and Downs of Primate Brain Evolution: Implications for Adaptive Hypotheses and Homo Floresiensis’. <em>BMC Biology</em> [online] 8 (1), 9. available from &lt;<a href="https://doi.org/10.1186/1741-7007-8-9">https://doi.org/10.1186/1741-7007-8-9</a>&gt;</p>
</div>
<div id="ref-Montgomery13">
<p>Montgomery, S.H., Geisler, J.H., McGowen, M.R., Fox, C., Marino, L., and Gatesy, J. (2013) <em>The Evolutionary History of Cetacean Brain and Body Size</em>. [online] 67 (11), 3339–3353. available from &lt;<a href="www.jstor.org/stable/24032748">www.jstor.org/stable/24032748</a>&gt;</p>
</div>
<div id="ref-Nunn11">
<p>Nunn, C.L. (2011) <em>The Comparative Approach in Evolutionary Anthropology and Biology</em> [online] University of Chicago Press. available from &lt;<a href="https://books.google.co.uk/books?id=qj4cSzJGQJAC">https://books.google.co.uk/books?id=qj4cSzJGQJAC</a>&gt;</p>
</div>
<div id="ref-ape">
<p>Paradis, E. and Schliep, K. (2018) ‘Ape 5.0: An Environment for Modern Phylogenetics and Evolutionary Analyses in R’. <em>Bioinformatics</em> 35, 526–528</p>
</div>
<div id="ref-phytools">
<p>Revell, L.J. (2012) ‘Phytools: An R Package for Phylogenetic Comparative Biology (and Other Things).’ <em>Methods in Ecology and Evolution</em> 3, 217–223</p>
</div>
<div id="ref-Serio19">
<p>Serio, C., Castiglione, S., Tesone, G., Piccolo, M., Melchionna, M., Mondanaro, A., Febbraro, M.D., and Raia, P. (2019) ‘Macroevolution of Toothed Whales Exceptional Relative Brain Size.’ <em>Evolutionary Biology</em> [online] 46, 332–342. available from &lt;<a href="https://link.springer.com/article/10.1007/s11692-019-09485-7">https://link.springer.com/article/10.1007/s11692-019-09485-7</a>&gt;</p>
</div>
<div id="ref-Slater12">
<p>Slater, G.J., Harmon, L.J., and Alfaro, M.E. (2012) ‘Integrating Fossils with Molecular Phylogenies Improves Inference of Trait Evolution’. <em>Evolution</em> [online] 66 (12), 3931–3944. available from &lt;<a href="https://doi.org/10.1111/j.1558-5646.2012.01723.x">https://doi.org/10.1111/j.1558-5646.2012.01723.x</a>&gt;</p>
</div>
<div id="ref-Thewissen09">
<p>Thewissen, J.G.M., Cooper, L.N., George, J.C., and Bajpai, S. (2009) ‘From Land to Water: The Origin of Whales, Dolphins, and Porpoises’. <em>Evolution: Education and Outreach</em> [online] 2 (2), 272–288. available from &lt;<a href="https://doi.org/10.1007/s12052-009-0135-2">https://doi.org/10.1007/s12052-009-0135-2</a>&gt;</p>
</div>
<div id="ref-Webster02">
<p>Webster, A.J. and Purvis, A. (2002) ‘Testing the Accuracy of Methods for Reconstructing Ancestral States of Continuous Characters’. <em>Proceedings of the Royal Society of London. Series B: Biological Sciences</em> [online] 269 (1487), 143–149. available from &lt;<a href="https://doi.org/10.1098/rspb.2001.1873">https://doi.org/10.1098/rspb.2001.1873</a>&gt;</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="asr1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="diversification.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
